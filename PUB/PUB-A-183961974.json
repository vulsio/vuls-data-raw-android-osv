{
	"schema_version": "1.6.0",
	"id": "PUB-A-183961974",
	"modified": "2024-08-29T07:12:53.440984Z",
	"published": "2021-12-01T00:00:00Z",
	"aliases": [
		"A-183961974",
		"CVE-2021-1006"
	],
	"details": "In several functions of DatabaseManager.java, there is a possible leak of Bluetooth MAC addresses due to log information disclosure. This could lead to local information disclosure with System execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/apps/Bluetooth"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12:0"
						},
						{
							"fixed": "12:2021-12-01"
						}
					]
				}
			],
			"versions": [
				"12"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/apps/Bluetooth/+/18b3d041032786e6ae392d3f613377c1b9387952"
				],
				"severity": "Moderate",
				"spl": "2021-12-01",
				"types": [
					"ID"
				],
				"vanir_signatures": [
					{
						"deprecated": true,
						"digest": {
							"line_hashes": [
								"296989764510661461712900671393280795557",
								"252659760325385202070263258521844127768",
								"183313366666209593482709261831911486217",
								"247442095202362123493973336284864244093",
								"310439367360772059087699579738830168658",
								"198382644793456981717956716170197181467",
								"128102074249952240501527657740836875419",
								"31714741489767873712696114269821095434",
								"24080022787716875662832125272842202020",
								"125933297451656399034358613451378401031",
								"138064147127538341376629042522891514422",
								"30896972633362777313414709671794067624",
								"124020168522760296635220371676548977764",
								"259592710667415811469873747776584929486",
								"282050746906532461745811918797898508864",
								"257208229457567583097613027569204929078",
								"273676388071902499230649180581649162664",
								"139790996822989434258352465274246103702",
								"290140834078409848046257404344576455897",
								"63368960085978866139673122401753646195",
								"229434402861826844444857104950806195909",
								"74826084410457052610083312089777974832",
								"45603088534331084547238087769341939928",
								"9209040779690729185311564968671577745",
								"281761181929356234015403815847699842435",
								"282287762494101411180933009763543167074",
								"156193658432633658523415914608835690074",
								"245459209970094420518437786444951852382",
								"221724886468799902126765519269624048247",
								"292573365659267327042635393671865348268",
								"301540819285098286948502987985017674596",
								"159651538939298866321450380274400387438",
								"14680921646257883166776693459242833391"
							],
							"threshold": 0.9
						},
						"id": "PUB-A-183961974-109945b6",
						"match_only_versions": [
							"12"
						],
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Bluetooth/+/18b3d041032786e6ae392d3f613377c1b9387952",
						"target": {
							"file": "src/com/android/bluetooth/btservice/storage/DatabaseManager.java"
						}
					},
					{
						"deprecated": true,
						"digest": {
							"function_hash": "66413717821040782136502856015621484392",
							"length": 491
						},
						"id": "PUB-A-183961974-139dda7f",
						"match_only_versions": [
							"12"
						],
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Bluetooth/+/18b3d041032786e6ae392d3f613377c1b9387952",
						"target": {
							"file": "src/com/android/bluetooth/btservice/storage/DatabaseManager.java",
							"function": "cacheMetadata"
						}
					},
					{
						"deprecated": true,
						"digest": {
							"function_hash": "108103863089962408337758670189559915804",
							"length": 682
						},
						"id": "PUB-A-183961974-329aa6cd",
						"match_only_versions": [
							"12"
						],
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Bluetooth/+/18b3d041032786e6ae392d3f613377c1b9387952",
						"target": {
							"file": "src/com/android/bluetooth/btservice/storage/DatabaseManager.java",
							"function": "getProfileConnectionPolicy"
						}
					},
					{
						"deprecated": true,
						"digest": {
							"function_hash": "221305025314524073196805065577572551648",
							"length": 320
						},
						"id": "PUB-A-183961974-a1df8b76",
						"match_only_versions": [
							"12"
						],
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Bluetooth/+/18b3d041032786e6ae392d3f613377c1b9387952",
						"target": {
							"file": "src/com/android/bluetooth/btservice/storage/DatabaseManager.java",
							"function": "updateDatabase"
						}
					},
					{
						"deprecated": true,
						"digest": {
							"function_hash": "36114397773330327129778108037385018501",
							"length": 705
						},
						"id": "PUB-A-183961974-d030fefa",
						"match_only_versions": [
							"12"
						],
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Bluetooth/+/18b3d041032786e6ae392d3f613377c1b9387952",
						"target": {
							"file": "src/com/android/bluetooth/btservice/storage/DatabaseManager.java",
							"function": "compactLastConnectionTime"
						}
					},
					{
						"deprecated": true,
						"digest": {
							"function_hash": "173327610058391887318488259863249789610",
							"length": 819
						},
						"id": "PUB-A-183961974-fdbcb6cd",
						"match_only_versions": [
							"12"
						],
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Bluetooth/+/18b3d041032786e6ae392d3f613377c1b9387952",
						"target": {
							"file": "src/com/android/bluetooth/btservice/storage/DatabaseManager.java",
							"function": "setConnection"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/PUB-A-183961974.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2021-12-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/packages/apps/Bluetooth/+/18b3d041032786e6ae392d3f613377c1b9387952"
		}
	]
}
