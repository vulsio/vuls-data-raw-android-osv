{
	"schema_version": "1.6.0",
	"id": "PUB-A-168314741",
	"modified": "2024-11-06T12:16:03.231308Z",
	"published": "2021-06-01T00:00:00Z",
	"aliases": [
		"A-168314741",
		"CVE-2021-0535"
	],
	"details": "In wpas_ctrl_msg_queue_timeout of ctrl_iface_unix.c, there is a possible memory corruption due to a use after free. This could lead to local escalation of privilege with System execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/external/wpa_supplicant_8"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2021-06-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879"
				],
				"severity": "Moderate",
				"spl": "2021-06-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "255221272812345816287146751446798328957",
							"length": 964
						},
						"id": "PUB-A-168314741-1279d210",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/eapol_test.c",
							"function": "test_eapol_clean"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"324224944521832216902413810294763058854",
								"223021637751403789914202961381847455816",
								"181519860626151829837465265594719926908",
								"314116482818598339730351934495183952011",
								"308563195467441528042503088298807416573",
								"49189616751850900505855863988084324459",
								"197367291509304854394574161768854896665",
								"121177266873016160393944027089843937648",
								"317585241308724371933329539886600863207",
								"271508234931146356307278515868182654764",
								"14513709726636530074979430540351370527",
								"169947061419009386104507390704334463309"
							],
							"threshold": 0.9
						},
						"id": "PUB-A-168314741-20c3bb97",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/wpa_supplicant.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"154278324720652045691983324936001138024",
								"138297329052734700502771650240692361999",
								"184691338277605792623041261110342957405",
								"163780524411711009116194692074883137669",
								"269874339130113271861858069356243028815"
							],
							"threshold": 0.9
						},
						"id": "PUB-A-168314741-4a9bf456",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/ctrl_iface_udp.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "339645610792782905372425482241794278600",
							"length": 199
						},
						"id": "PUB-A-168314741-52a7ac9f",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/ctrl_iface_named_pipe.c",
							"function": "wpa_supplicant_ctrl_iface_deinit"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"214015854645515696031714670508575233605",
								"300872652129144151476740241696628327738",
								"94326112287864625846990263683075209037",
								"317585241308724371933329539886600863207",
								"238844417543132162478063268088755953943",
								"231943082385211630905957969296042366654",
								"149048653503051112061905981476089865328"
							],
							"threshold": 0.9
						},
						"id": "PUB-A-168314741-54a3c20c",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/eapol_test.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "336886352105675562525092246996917960995",
							"length": 1842
						},
						"id": "PUB-A-168314741-7797aff9",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/wpa_supplicant.c",
							"function": "wpa_supplicant_reload_configuration"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "136358474572641823660726129686400312291",
							"length": 1734
						},
						"id": "PUB-A-168314741-8c1c8946",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/wpa_supplicant.c",
							"function": "wpa_supplicant_deinit_iface"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "184002198109187980578282540668146603811",
							"length": 353
						},
						"id": "PUB-A-168314741-99c3acfe",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/ctrl_iface_udp.c",
							"function": "wpa_supplicant_ctrl_iface_deinit"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"299682739740377224216230395361313206202",
								"220838738554821361676285900929848478644",
								"307405233462075927095863906320808146920",
								"45293169331765785866764871544084351955"
							],
							"threshold": 0.9
						},
						"id": "PUB-A-168314741-9b1a99b1",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/ctrl_iface.h"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "206701849151375626764316206793073468087",
							"length": 281
						},
						"id": "PUB-A-168314741-a46e6eb2",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/preauth_test.c",
							"function": "test_eapol_clean"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"197726599476935003342424801133626832754",
								"97013973258263576878895615073679516609",
								"94326112287864625846990263683075209037",
								"317585241308724371933329539886600863207",
								"184873678805814754837708811583657039969",
								"304543135186576861183659833536477980852",
								"23120037749954884921676187229747152791"
							],
							"threshold": 0.9
						},
						"id": "PUB-A-168314741-a9bc254d",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/preauth_test.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"106320876702156891369201710764387353380",
								"42372878522536564640962863056452298294",
								"30619712853836741008981496065416234461",
								"27529741942155759198711509899955799942",
								"220173331599441609301029860087055130086"
							],
							"threshold": 0.9
						},
						"id": "PUB-A-168314741-b1e5b07c",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/ctrl_iface_named_pipe.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"273712968140368510215188114355183266301",
								"183959815612524542869073488315591823641",
								"22910609964803125148987754357666752036",
								"105179286070530866083815634723385510492",
								"249162187837087719747939800510886096084",
								"271780864353430800712919835382971790868",
								"287428154666958444539023700647340779978",
								"67546414371249224231691111937678400281",
								"293319914698659165539860124064005859892",
								"180455904005349479910379480878688712232",
								"285056368220928283304898083202609869790",
								"227293194231127253182299027572125258601"
							],
							"threshold": 0.9
						},
						"id": "PUB-A-168314741-e2b9db81",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/ctrl_iface_unix.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "238203272345957292638467193686741828180",
							"length": 1693
						},
						"id": "PUB-A-168314741-f37d66a2",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879",
						"target": {
							"file": "wpa_supplicant/ctrl_iface_unix.c",
							"function": "wpa_supplicant_ctrl_iface_deinit"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/PUB-A-168314741.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2021-06-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/external/wpa_supplicant_8/+/6ba121e906a12f922dbd910f7a3132c43c510879"
		}
	]
}
