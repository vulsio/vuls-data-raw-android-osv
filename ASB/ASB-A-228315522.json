{
	"schema_version": "1.6.0",
	"id": "ASB-A-228315522",
	"modified": "2024-11-06T12:16:03.231308Z",
	"published": "2022-08-01T00:00:00Z",
	"aliases": [
		"A-228315522",
		"CVE-2022-20349"
	],
	"details": "In WifiScanningPreferenceController and BluetoothScanningPreferenceController, there is a possible admin restriction bypass due to a missing permission check. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/apps/Settings"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "10:0"
						},
						{
							"fixed": "10:2022-08-01"
						}
					]
				}
			],
			"versions": [
				"10"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/apps/Settings/+/9eff8f7a8d5140a4b674fa09cf333dce07fde76c"
				],
				"severity": "High",
				"spl": "2022-08-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"265465987013571789731866987743409649342",
								"4703971492495835339413932759341780259",
								"74030185683773627306434947612648689550",
								"49050924439937700606596489369234830836",
								"222443017917360690017754529722523641113",
								"3538585105184413301890922817798770757",
								"151265195881969875167420159758709121206",
								"160758846789364349478991974818197348061",
								"57333174814954139472941571485369201419",
								"162810954599727497233229275668901085602"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-228315522-03e91258",
						"match_only_versions": [
							"10"
						],
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/9eff8f7a8d5140a4b674fa09cf333dce07fde76c",
						"target": {
							"file": "src/com/android/settings/location/BluetoothScanningPreferenceController.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "56285076236989732979052329536235063044",
							"length": 186
						},
						"id": "ASB-A-228315522-999e5a56",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/9eff8f7a8d5140a4b674fa09cf333dce07fde76c",
						"target": {
							"file": "src/com/android/settings/location/WifiScanningPreferenceController.java",
							"function": "updateState"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "278374646945805599418603771097304578314",
							"length": 185
						},
						"id": "ASB-A-228315522-c2b0e8df",
						"match_only_versions": [
							"10"
						],
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/9eff8f7a8d5140a4b674fa09cf333dce07fde76c",
						"target": {
							"file": "src/com/android/settings/location/BluetoothScanningPreferenceController.java",
							"function": "updateState"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"265465987013571789731866987743409649342",
								"4703971492495835339413932759341780259",
								"74030185683773627306434947612648689550",
								"49050924439937700606596489369234830836",
								"331623947982505324421344649724979599117",
								"69646381778251111192855656214076355452",
								"102388134778754710759175228443148470720",
								"293414423130308108572655506937453655891",
								"125518742726547323115013234190643707942",
								"153062644858345650483652076748445622232"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-228315522-c4dbdef6",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/9eff8f7a8d5140a4b674fa09cf333dce07fde76c",
						"target": {
							"file": "src/com/android/settings/location/WifiScanningPreferenceController.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-228315522.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/apps/Settings"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2022-08-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/apps/Settings/+/78799a550a6ea1bb9596b6b3ab6402ec8a038d6b"
				],
				"severity": "High",
				"spl": "2022-08-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"265465987013571789731866987743409649342",
								"4703971492495835339413932759341780259",
								"74030185683773627306434947612648689550",
								"49050924439937700606596489369234830836",
								"222443017917360690017754529722523641113",
								"3538585105184413301890922817798770757",
								"151265195881969875167420159758709121206",
								"160758846789364349478991974818197348061",
								"57333174814954139472941571485369201419",
								"162810954599727497233229275668901085602"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-228315522-17f00294",
						"match_only_versions": [
							"11"
						],
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/78799a550a6ea1bb9596b6b3ab6402ec8a038d6b",
						"target": {
							"file": "src/com/android/settings/location/BluetoothScanningPreferenceController.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "69427656324706457413289664527387219035",
							"length": 99
						},
						"id": "ASB-A-228315522-1c3ad36f",
						"match_only_versions": [
							"11"
						],
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/78799a550a6ea1bb9596b6b3ab6402ec8a038d6b",
						"target": {
							"file": "src/com/android/settings/location/WifiScanningPreferenceController.java",
							"function": "updateState"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "278374646945805599418603771097304578314",
							"length": 185
						},
						"id": "ASB-A-228315522-49aab251",
						"match_only_versions": [
							"11"
						],
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/78799a550a6ea1bb9596b6b3ab6402ec8a038d6b",
						"target": {
							"file": "src/com/android/settings/location/BluetoothScanningPreferenceController.java",
							"function": "updateState"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"99013913879519102696052055958703064814",
								"273112918311817402637346768846857481701",
								"116167251503346558547168483310405139848",
								"49050924439937700606596489369234830836",
								"331623947982505324421344649724979599117",
								"69646381778251111192855656214076355452",
								"55283459930248996080395394811273838496",
								"96214475995893836858128639684984834011",
								"173747867879277242298206448091462430065",
								"73863378189117060576880904204475074790"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-228315522-594ebf72",
						"match_only_versions": [
							"11"
						],
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/78799a550a6ea1bb9596b6b3ab6402ec8a038d6b",
						"target": {
							"file": "src/com/android/settings/location/WifiScanningPreferenceController.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-228315522.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/apps/Settings"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12:0"
						},
						{
							"fixed": "12:2022-08-01"
						}
					]
				}
			],
			"versions": [
				"12"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/apps/Settings/+/2598a722aef1a65fec2d9b66baf9e800fc72a7b5"
				],
				"severity": "High",
				"spl": "2022-08-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"23184264711393498245071180914282103853",
								"39830521234849944994946219590550681399",
								"155742129727250883708337687041073810118",
								"186815278412314358408507146272859954620",
								"77554387441052516123725910865319920933",
								"54363651335152508179042401468724200768",
								"230472932547116660262194911836233962432",
								"307796422129454952691797021981263351806",
								"71764438366883257694047763597142363304"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-228315522-9b6b8933",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/2598a722aef1a65fec2d9b66baf9e800fc72a7b5",
						"target": {
							"file": "src/com/android/settings/location/LocationServicesWifiScanningPreferenceController.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"207585097716181857473610334268529485662",
								"104112774008292982919074669773195409078",
								"818305010081487469473605815201587168",
								"119565777377284312808097834309661931797",
								"25570923306797230711182842373920540320",
								"628899777667075318127744147607438616",
								"285521936436543950598816968694483023971",
								"20554669810498112072569640539367194770",
								"34221006646433070456653649588856518669"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-228315522-fca32918",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/2598a722aef1a65fec2d9b66baf9e800fc72a7b5",
						"target": {
							"file": "src/com/android/settings/location/LocationServicesBluetoothScanningPreferenceController.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-228315522.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/apps/Settings"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12L:0"
						},
						{
							"fixed": "12L:2022-08-01"
						}
					]
				}
			],
			"versions": [
				"12L"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/apps/Settings/+/a12fff673b59d7674b2ba04f30e92a9941fff7ac"
				],
				"severity": "High",
				"spl": "2022-08-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"23184264711393498245071180914282103853",
								"39830521234849944994946219590550681399",
								"155742129727250883708337687041073810118",
								"186815278412314358408507146272859954620",
								"77554387441052516123725910865319920933",
								"54363651335152508179042401468724200768",
								"230472932547116660262194911836233962432",
								"307796422129454952691797021981263351806",
								"71764438366883257694047763597142363304"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-228315522-be8b3c95",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/a12fff673b59d7674b2ba04f30e92a9941fff7ac",
						"target": {
							"file": "src/com/android/settings/location/LocationServicesWifiScanningPreferenceController.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"207585097716181857473610334268529485662",
								"104112774008292982919074669773195409078",
								"818305010081487469473605815201587168",
								"119565777377284312808097834309661931797",
								"25570923306797230711182842373920540320",
								"628899777667075318127744147607438616",
								"285521936436543950598816968694483023971",
								"20554669810498112072569640539367194770",
								"34221006646433070456653649588856518669"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-228315522-dda57312",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/a12fff673b59d7674b2ba04f30e92a9941fff7ac",
						"target": {
							"file": "src/com/android/settings/location/LocationServicesBluetoothScanningPreferenceController.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-228315522.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2022-08-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/packages/apps/Settings/+/ba075274a7acc99bb15e3c3306b2768356aa0459"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/packages/modules/Bluetooth/+/0b7fe01dd050fa4155b1cd802d901b4c9eccdfef"
		}
	]
}
