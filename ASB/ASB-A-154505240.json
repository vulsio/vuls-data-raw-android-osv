{
	"schema_version": "1.6.0",
	"id": "ASB-A-154505240",
	"modified": "2024-11-06T12:16:03.231308Z",
	"published": "2021-01-01T00:00:00Z",
	"aliases": [
		"A-154505240",
		"CVE-2021-0306"
	],
	"details": "In addAllPermissions of PermissionManagerService.java, there is a possible permissions bypass when upgrading major Android versions which allows an app to gain the android.permission.ACTIVITY_RECOGNITION permission without user confirmation. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "8.0:0"
						},
						{
							"fixed": "8.0:2021-01-01"
						}
					]
				}
			],
			"versions": [
				"8.0"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
					"https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47"
				],
				"severity": "High",
				"spl": "2021-01-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "21421224678198374583561995211664882601",
							"length": 1221
						},
						"id": "ASB-A-154505240-09a152bd",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java",
							"function": "addAllPermissions"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"289811285372936441608998005850848669366",
								"83759447574929438521616183101859426367",
								"257605848614350064685661022222882882739",
								"116131610654758275584443769016520760253",
								"109781855832801912132769778679703357397",
								"253029579488782257276657767625052502005",
								"179776872512405308593444319273477467039",
								"131903200419937242928888849099705053244",
								"59405954054252342237272360452282737724",
								"334025463905376183125865018950293303505",
								"248571963711484214882573784841218031878",
								"91012237829001333592917401392071944829",
								"137231561800317290996346725192784322959",
								"268344403566588832728607397410323559431",
								"49324204063863447543405238445752274404",
								"316011342008265777932306114968080712552",
								"85375638520296940495340159941148317999",
								"29297400215145069558622771334316872749",
								"191480934947575433382958417558155804219",
								"87781564864534790861522201320472844462"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-23d28063",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "114212502052990909611663369815182127013",
							"length": 2709
						},
						"id": "ASB-A-154505240-3f270ab7",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "159669981910848186740133655022903054465",
							"length": 2873
						},
						"id": "ASB-A-154505240-431f8199",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"143476902959642847943055954792032725845",
								"176964326523071306477059947160670629917",
								"91577716533003906884243831932707696957",
								"66276092657805374114651483027988513275",
								"309649039885879178094086296347169225310",
								"223312593299153245042383338576126317818",
								"169879846418248370023234200480470829182",
								"263455046005417147494444945811962185849",
								"131719520565472500803769667144221752570",
								"236009843299909237528397699091012593770",
								"128522789892127712610876544755748307002",
								"12880903814973698728245862938660751165",
								"14865066139850281105241480085746941299",
								"219331970819655213703432744183357258357",
								"87007855509531788612089117682038888866",
								"97823432799475984771545501975588352053",
								"285337850518120861780830204422936365264",
								"294589232152381550392098724459088504809",
								"172678423482035343823754281216957189868",
								"45612388801792507471354248304976494240",
								"103157704587070679864015125482144521459",
								"233655310777596817989740401202875441725",
								"26522370238390989555148415572239208509",
								"176082462105145657880394229315313141008",
								"316808648603564359400096253730964558037"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-4f072f7e",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "312012632730370821592806972185889554073",
							"length": 4811
						},
						"id": "ASB-A-154505240-8628dae7",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java",
							"function": "commitPackageSettings"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"251384382309912983979322755058625369683",
								"311289309463715119940104244038301335604",
								"128173217221224440694226038254001880923",
								"178905456364939046692486212254089408776",
								"100298351891793561420109665685221408977",
								"202544306061842768661778530041411491780",
								"117999045206388857935211550903068516872",
								"298220015180558678325140269908559158725",
								"136082572035234204949383201778256196874",
								"143067254765762748936446684675453668350",
								"298739292702900709498461503071102507336",
								"155309025154458176002986068041093262044",
								"117448914110600566550271943186863365253",
								"60610543726077013592834502469459337610",
								"169140703216154219845524374616183125500",
								"295909156963144231232450809841827601567",
								"170559496502834959564372666831228915614",
								"151487443117193885900778881541547210095",
								"1854812884654466014787215287598615426",
								"37316612375317139229140737861009643618",
								"108587633537507210242609878158511307392",
								"141298887675449291704785166078574702107",
								"175363122350157990959228372781996599983",
								"86349647666249459856572696221300111365",
								"150492524989557413152828221685501141189",
								"263798106085759466927047082618839658302",
								"176641774956283071640464639105059963377",
								"217442106292773927184635146035381635640",
								"216975017876702193162208922247793645584",
								"49536444265582144699834317502624864661"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-a55dbc73",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"300558797478455665228977041073332740161",
								"229089149346645259548452564495478783989",
								"158516251953092459809047713070131326523",
								"23878212559383681882692447600667961378",
								"309214319754859876925951608291378068273",
								"38034053912912518898345619210675635579",
								"106001563314996809083498962546828590825",
								"102279475340615476629214848145454800846"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-b8307471",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"297695226331415782691685438379309903520",
								"100850522468957255933958610351944489467",
								"218897607903436483273174225807192019061",
								"225248068792210588984837350203868350357"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-d5cf29a0",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerServiceInternal.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-154505240.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "8.1:0"
						},
						{
							"fixed": "8.1:2021-01-01"
						}
					]
				}
			],
			"versions": [
				"8.1"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
					"https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47"
				],
				"severity": "High",
				"spl": "2021-01-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "114212502052990909611663369815182127013",
							"length": 2709
						},
						"id": "ASB-A-154505240-00fafbad",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"143476902959642847943055954792032725845",
								"176964326523071306477059947160670629917",
								"91577716533003906884243831932707696957",
								"66276092657805374114651483027988513275",
								"309649039885879178094086296347169225310",
								"223312593299153245042383338576126317818",
								"169879846418248370023234200480470829182",
								"263455046005417147494444945811962185849",
								"131719520565472500803769667144221752570",
								"236009843299909237528397699091012593770",
								"128522789892127712610876544755748307002",
								"12880903814973698728245862938660751165",
								"14865066139850281105241480085746941299",
								"219331970819655213703432744183357258357",
								"87007855509531788612089117682038888866",
								"97823432799475984771545501975588352053",
								"285337850518120861780830204422936365264",
								"294589232152381550392098724459088504809",
								"172678423482035343823754281216957189868",
								"45612388801792507471354248304976494240",
								"103157704587070679864015125482144521459",
								"233655310777596817989740401202875441725",
								"26522370238390989555148415572239208509",
								"176082462105145657880394229315313141008",
								"316808648603564359400096253730964558037"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-0f8bee9d",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "312012632730370821592806972185889554073",
							"length": 4811
						},
						"id": "ASB-A-154505240-3e7dafa7",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java",
							"function": "commitPackageSettings"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "159669981910848186740133655022903054465",
							"length": 2873
						},
						"id": "ASB-A-154505240-4471fe7c",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"300558797478455665228977041073332740161",
								"229089149346645259548452564495478783989",
								"158516251953092459809047713070131326523",
								"23878212559383681882692447600667961378",
								"309214319754859876925951608291378068273",
								"38034053912912518898345619210675635579",
								"106001563314996809083498962546828590825",
								"102279475340615476629214848145454800846"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-91caa67f",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"289811285372936441608998005850848669366",
								"83759447574929438521616183101859426367",
								"257605848614350064685661022222882882739",
								"116131610654758275584443769016520760253",
								"109781855832801912132769778679703357397",
								"253029579488782257276657767625052502005",
								"179776872512405308593444319273477467039",
								"131903200419937242928888849099705053244",
								"59405954054252342237272360452282737724",
								"334025463905376183125865018950293303505",
								"248571963711484214882573784841218031878",
								"91012237829001333592917401392071944829",
								"137231561800317290996346725192784322959",
								"268344403566588832728607397410323559431",
								"49324204063863447543405238445752274404",
								"316011342008265777932306114968080712552",
								"85375638520296940495340159941148317999",
								"29297400215145069558622771334316872749",
								"191480934947575433382958417558155804219",
								"87781564864534790861522201320472844462"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-b3b158fa",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"251384382309912983979322755058625369683",
								"311289309463715119940104244038301335604",
								"128173217221224440694226038254001880923",
								"178905456364939046692486212254089408776",
								"100298351891793561420109665685221408977",
								"202544306061842768661778530041411491780",
								"117999045206388857935211550903068516872",
								"298220015180558678325140269908559158725",
								"136082572035234204949383201778256196874",
								"143067254765762748936446684675453668350",
								"298739292702900709498461503071102507336",
								"155309025154458176002986068041093262044",
								"117448914110600566550271943186863365253",
								"60610543726077013592834502469459337610",
								"169140703216154219845524374616183125500",
								"295909156963144231232450809841827601567",
								"170559496502834959564372666831228915614",
								"151487443117193885900778881541547210095",
								"1854812884654466014787215287598615426",
								"37316612375317139229140737861009643618",
								"108587633537507210242609878158511307392",
								"141298887675449291704785166078574702107",
								"175363122350157990959228372781996599983",
								"86349647666249459856572696221300111365",
								"150492524989557413152828221685501141189",
								"263798106085759466927047082618839658302",
								"176641774956283071640464639105059963377",
								"217442106292773927184635146035381635640",
								"216975017876702193162208922247793645584",
								"49536444265582144699834317502624864661"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-bc847783",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"297695226331415782691685438379309903520",
								"100850522468957255933958610351944489467",
								"218897607903436483273174225807192019061",
								"225248068792210588984837350203868350357"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-ca2bf45f",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerServiceInternal.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "21421224678198374583561995211664882601",
							"length": 1221
						},
						"id": "ASB-A-154505240-ff4efa2a",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java",
							"function": "addAllPermissions"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-154505240.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "9:0"
						},
						{
							"fixed": "9:2021-01-01"
						}
					]
				}
			],
			"versions": [
				"9"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
					"https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47"
				],
				"severity": "High",
				"spl": "2021-01-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"251384382309912983979322755058625369683",
								"311289309463715119940104244038301335604",
								"128173217221224440694226038254001880923",
								"178905456364939046692486212254089408776",
								"100298351891793561420109665685221408977",
								"202544306061842768661778530041411491780",
								"117999045206388857935211550903068516872",
								"298220015180558678325140269908559158725",
								"136082572035234204949383201778256196874",
								"143067254765762748936446684675453668350",
								"298739292702900709498461503071102507336",
								"155309025154458176002986068041093262044",
								"117448914110600566550271943186863365253",
								"60610543726077013592834502469459337610",
								"169140703216154219845524374616183125500",
								"295909156963144231232450809841827601567",
								"170559496502834959564372666831228915614",
								"151487443117193885900778881541547210095",
								"1854812884654466014787215287598615426",
								"37316612375317139229140737861009643618",
								"108587633537507210242609878158511307392",
								"141298887675449291704785166078574702107",
								"175363122350157990959228372781996599983",
								"86349647666249459856572696221300111365",
								"150492524989557413152828221685501141189",
								"263798106085759466927047082618839658302",
								"176641774956283071640464639105059963377",
								"217442106292773927184635146035381635640",
								"216975017876702193162208922247793645584",
								"49536444265582144699834317502624864661"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-23f88bb7",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "159669981910848186740133655022903054465",
							"length": 2873
						},
						"id": "ASB-A-154505240-412e37a2",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"143476902959642847943055954792032725845",
								"176964326523071306477059947160670629917",
								"91577716533003906884243831932707696957",
								"66276092657805374114651483027988513275",
								"309649039885879178094086296347169225310",
								"223312593299153245042383338576126317818",
								"169879846418248370023234200480470829182",
								"263455046005417147494444945811962185849",
								"131719520565472500803769667144221752570",
								"236009843299909237528397699091012593770",
								"128522789892127712610876544755748307002",
								"12880903814973698728245862938660751165",
								"14865066139850281105241480085746941299",
								"219331970819655213703432744183357258357",
								"87007855509531788612089117682038888866",
								"97823432799475984771545501975588352053",
								"285337850518120861780830204422936365264",
								"294589232152381550392098724459088504809",
								"172678423482035343823754281216957189868",
								"45612388801792507471354248304976494240",
								"103157704587070679864015125482144521459",
								"233655310777596817989740401202875441725",
								"26522370238390989555148415572239208509",
								"176082462105145657880394229315313141008",
								"316808648603564359400096253730964558037"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-63d59f7a",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"300558797478455665228977041073332740161",
								"229089149346645259548452564495478783989",
								"158516251953092459809047713070131326523",
								"23878212559383681882692447600667961378",
								"309214319754859876925951608291378068273",
								"38034053912912518898345619210675635579",
								"106001563314996809083498962546828590825",
								"102279475340615476629214848145454800846"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-85f3cf20",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"289811285372936441608998005850848669366",
								"83759447574929438521616183101859426367",
								"257605848614350064685661022222882882739",
								"116131610654758275584443769016520760253",
								"109781855832801912132769778679703357397",
								"253029579488782257276657767625052502005",
								"179776872512405308593444319273477467039",
								"131903200419937242928888849099705053244",
								"59405954054252342237272360452282737724",
								"334025463905376183125865018950293303505",
								"248571963711484214882573784841218031878",
								"91012237829001333592917401392071944829",
								"137231561800317290996346725192784322959",
								"268344403566588832728607397410323559431",
								"49324204063863447543405238445752274404",
								"316011342008265777932306114968080712552",
								"85375638520296940495340159941148317999",
								"29297400215145069558622771334316872749",
								"191480934947575433382958417558155804219",
								"87781564864534790861522201320472844462"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-98349751",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "114212502052990909611663369815182127013",
							"length": 2709
						},
						"id": "ASB-A-154505240-ca0820ad",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "312012632730370821592806972185889554073",
							"length": 4811
						},
						"id": "ASB-A-154505240-e734432d",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java",
							"function": "commitPackageSettings"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "21421224678198374583561995211664882601",
							"length": 1221
						},
						"id": "ASB-A-154505240-ea5689df",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java",
							"function": "addAllPermissions"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"297695226331415782691685438379309903520",
								"100850522468957255933958610351944489467",
								"218897607903436483273174225807192019061",
								"225248068792210588984837350203868350357"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-f0f72c19",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerServiceInternal.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-154505240.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "10:0"
						},
						{
							"fixed": "10:2021-01-01"
						}
					]
				}
			],
			"versions": [
				"10"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
					"https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47"
				],
				"severity": "High",
				"spl": "2021-01-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "114212502052990909611663369815182127013",
							"length": 2709
						},
						"id": "ASB-A-154505240-0e8c2602",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "21421224678198374583561995211664882601",
							"length": 1221
						},
						"id": "ASB-A-154505240-281b8713",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java",
							"function": "addAllPermissions"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"251384382309912983979322755058625369683",
								"311289309463715119940104244038301335604",
								"128173217221224440694226038254001880923",
								"178905456364939046692486212254089408776",
								"100298351891793561420109665685221408977",
								"202544306061842768661778530041411491780",
								"117999045206388857935211550903068516872",
								"298220015180558678325140269908559158725",
								"136082572035234204949383201778256196874",
								"143067254765762748936446684675453668350",
								"298739292702900709498461503071102507336",
								"155309025154458176002986068041093262044",
								"117448914110600566550271943186863365253",
								"60610543726077013592834502469459337610",
								"169140703216154219845524374616183125500",
								"295909156963144231232450809841827601567",
								"170559496502834959564372666831228915614",
								"151487443117193885900778881541547210095",
								"1854812884654466014787215287598615426",
								"37316612375317139229140737861009643618",
								"108587633537507210242609878158511307392",
								"141298887675449291704785166078574702107",
								"175363122350157990959228372781996599983",
								"86349647666249459856572696221300111365",
								"150492524989557413152828221685501141189",
								"263798106085759466927047082618839658302",
								"176641774956283071640464639105059963377",
								"217442106292773927184635146035381635640",
								"216975017876702193162208922247793645584",
								"49536444265582144699834317502624864661"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-4b22f3ca",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"300558797478455665228977041073332740161",
								"229089149346645259548452564495478783989",
								"158516251953092459809047713070131326523",
								"23878212559383681882692447600667961378",
								"309214319754859876925951608291378068273",
								"38034053912912518898345619210675635579",
								"106001563314996809083498962546828590825",
								"102279475340615476629214848145454800846"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-7092be5b",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "312012632730370821592806972185889554073",
							"length": 4811
						},
						"id": "ASB-A-154505240-830e6307",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java",
							"function": "commitPackageSettings"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"143476902959642847943055954792032725845",
								"176964326523071306477059947160670629917",
								"91577716533003906884243831932707696957",
								"66276092657805374114651483027988513275",
								"309649039885879178094086296347169225310",
								"223312593299153245042383338576126317818",
								"169879846418248370023234200480470829182",
								"263455046005417147494444945811962185849",
								"131719520565472500803769667144221752570",
								"236009843299909237528397699091012593770",
								"128522789892127712610876544755748307002",
								"12880903814973698728245862938660751165",
								"14865066139850281105241480085746941299",
								"219331970819655213703432744183357258357",
								"87007855509531788612089117682038888866",
								"97823432799475984771545501975588352053",
								"285337850518120861780830204422936365264",
								"294589232152381550392098724459088504809",
								"172678423482035343823754281216957189868",
								"45612388801792507471354248304976494240",
								"103157704587070679864015125482144521459",
								"233655310777596817989740401202875441725",
								"26522370238390989555148415572239208509",
								"176082462105145657880394229315313141008",
								"316808648603564359400096253730964558037"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-c9a10105",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "159669981910848186740133655022903054465",
							"length": 2873
						},
						"id": "ASB-A-154505240-d0b18bcf",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"297695226331415782691685438379309903520",
								"100850522468957255933958610351944489467",
								"218897607903436483273174225807192019061",
								"225248068792210588984837350203868350357"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-ee747568",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerServiceInternal.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"289811285372936441608998005850848669366",
								"83759447574929438521616183101859426367",
								"257605848614350064685661022222882882739",
								"116131610654758275584443769016520760253",
								"109781855832801912132769778679703357397",
								"253029579488782257276657767625052502005",
								"179776872512405308593444319273477467039",
								"131903200419937242928888849099705053244",
								"59405954054252342237272360452282737724",
								"334025463905376183125865018950293303505",
								"248571963711484214882573784841218031878",
								"91012237829001333592917401392071944829",
								"137231561800317290996346725192784322959",
								"268344403566588832728607397410323559431",
								"49324204063863447543405238445752274404",
								"316011342008265777932306114968080712552",
								"85375638520296940495340159941148317999",
								"29297400215145069558622771334316872749",
								"191480934947575433382958417558155804219",
								"87781564864534790861522201320472844462"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-fdba9f51",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-154505240.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2021-01-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
					"https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47"
				],
				"severity": "High",
				"spl": "2021-01-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"300558797478455665228977041073332740161",
								"229089149346645259548452564495478783989",
								"158516251953092459809047713070131326523",
								"23878212559383681882692447600667961378",
								"309214319754859876925951608291378068273",
								"38034053912912518898345619210675635579",
								"106001563314996809083498962546828590825",
								"102279475340615476629214848145454800846"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-06ed3e21",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"143476902959642847943055954792032725845",
								"176964326523071306477059947160670629917",
								"91577716533003906884243831932707696957",
								"66276092657805374114651483027988513275",
								"309649039885879178094086296347169225310",
								"223312593299153245042383338576126317818",
								"169879846418248370023234200480470829182",
								"263455046005417147494444945811962185849",
								"131719520565472500803769667144221752570",
								"236009843299909237528397699091012593770",
								"128522789892127712610876544755748307002",
								"12880903814973698728245862938660751165",
								"14865066139850281105241480085746941299",
								"219331970819655213703432744183357258357",
								"87007855509531788612089117682038888866",
								"97823432799475984771545501975588352053",
								"285337850518120861780830204422936365264",
								"294589232152381550392098724459088504809",
								"172678423482035343823754281216957189868",
								"45612388801792507471354248304976494240",
								"103157704587070679864015125482144521459",
								"233655310777596817989740401202875441725",
								"26522370238390989555148415572239208509",
								"176082462105145657880394229315313141008",
								"316808648603564359400096253730964558037"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-0e3d7cf2",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "312012632730370821592806972185889554073",
							"length": 4811
						},
						"id": "ASB-A-154505240-1da83586",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java",
							"function": "commitPackageSettings"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"251384382309912983979322755058625369683",
								"311289309463715119940104244038301335604",
								"128173217221224440694226038254001880923",
								"178905456364939046692486212254089408776",
								"100298351891793561420109665685221408977",
								"202544306061842768661778530041411491780",
								"117999045206388857935211550903068516872",
								"298220015180558678325140269908559158725",
								"136082572035234204949383201778256196874",
								"143067254765762748936446684675453668350",
								"298739292702900709498461503071102507336",
								"155309025154458176002986068041093262044",
								"117448914110600566550271943186863365253",
								"60610543726077013592834502469459337610",
								"169140703216154219845524374616183125500",
								"295909156963144231232450809841827601567",
								"170559496502834959564372666831228915614",
								"151487443117193885900778881541547210095",
								"1854812884654466014787215287598615426",
								"37316612375317139229140737861009643618",
								"108587633537507210242609878158511307392",
								"141298887675449291704785166078574702107",
								"175363122350157990959228372781996599983",
								"86349647666249459856572696221300111365",
								"150492524989557413152828221685501141189",
								"263798106085759466927047082618839658302",
								"176641774956283071640464639105059963377",
								"217442106292773927184635146035381635640",
								"216975017876702193162208922247793645584",
								"49536444265582144699834317502624864661"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-2bbe7867",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "21421224678198374583561995211664882601",
							"length": 1221
						},
						"id": "ASB-A-154505240-59c85601",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java",
							"function": "addAllPermissions"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"289811285372936441608998005850848669366",
								"83759447574929438521616183101859426367",
								"257605848614350064685661022222882882739",
								"116131610654758275584443769016520760253",
								"109781855832801912132769778679703357397",
								"253029579488782257276657767625052502005",
								"179776872512405308593444319273477467039",
								"131903200419937242928888849099705053244",
								"59405954054252342237272360452282737724",
								"334025463905376183125865018950293303505",
								"248571963711484214882573784841218031878",
								"91012237829001333592917401392071944829",
								"137231561800317290996346725192784322959",
								"268344403566588832728607397410323559431",
								"49324204063863447543405238445752274404",
								"316011342008265777932306114968080712552",
								"85375638520296940495340159941148317999",
								"29297400215145069558622771334316872749",
								"191480934947575433382958417558155804219",
								"87781564864534790861522201320472844462"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-963e9a31",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "159669981910848186740133655022903054465",
							"length": 2873
						},
						"id": "ASB-A-154505240-a229c7b8",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"297695226331415782691685438379309903520",
								"100850522468957255933958610351944489467",
								"218897607903436483273174225807192019061",
								"225248068792210588984837350203868350357"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-154505240-c722be87",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/PermissionManagerServiceInternal.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "114212502052990909611663369815182127013",
							"length": 2709
						},
						"id": "ASB-A-154505240-e1fe7b6b",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404",
						"target": {
							"file": "services/core/java/com/android/server/pm/permission/BasePermission.java",
							"function": "createOrUpdate"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-154505240.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2021-01-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/frameworks/base/+/03da463b2a94c36e3b46f0a110ec43710b82d404"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/frameworks/base/+/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47"
		}
	]
}
