{
	"schema_version": "1.6.0",
	"id": "ASB-A-184569329",
	"modified": "2024-10-02T23:34:40Z",
	"published": "2021-10-01T00:00:00Z",
	"aliases": [
		"A-184569329",
		"CVE-2021-0703"
	],
	"details": "In SecondStageMain of init.cpp, there is a possible use after free due to incorrect shared_ptr usage. This could lead to local escalation of privilege if the attacker has physical access to the device, with no additional execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/system/core"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12-next:0"
						},
						{
							"fixed": "12-next:2021-10-01"
						}
					]
				}
			],
			"versions": [
				"12-next"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/system/core/+/aea97815308ab98faf1599c16d6190b787d34941"
				],
				"severity": "High",
				"spl": "2021-10-01",
				"types": [
					"EoP",
					"Unknown"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"256138232892956117866870139568461073285",
								"210901955371522732331476274575937147501",
								"71044469235361559697024243045342578651",
								"298486968480583062652358300718990121853",
								"198470958570169884216143815249370508518",
								"144424847953029706394940655558779159721",
								"328849048575849043808407977646358186686",
								"140978676307643273134672054552574612510",
								"40428537916653978894019786492890279609",
								"162727022106112610027853147196649408344",
								"20591997319400182566179770889043122724",
								"202812449965763165842019963335729207713",
								"196474102583057658122448055249878807204",
								"293110444877043788342245703148328803143",
								"282825968526689080629089878204136507465",
								"101493045286489171594783699499528104478",
								"287158927481532591624954278076523875220",
								"328392510797919960404777263467970348176"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-184569329-294ed8ba",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/system/core/+/aea97815308ab98faf1599c16d6190b787d34941",
						"target": {
							"file": "init/epoll.cpp"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"328309416986978941964763700139281564765",
								"324118592480733914100375865052153519981",
								"148310415285163141198917495033497700105",
								"173261846682665274398296137622502839763",
								"234245473619591294809665721557795555579",
								"42369555006476525743163514753864323876",
								"66192061184800604454912141422104078394",
								"292653816015694727543108469855470597638",
								"165094782990866898258592092369424346133",
								"138814815098468961028611920680867551914",
								"73855890458803554921388581511882377543",
								"238809573335510810988767080431005283731",
								"95404780966911486944577072848118094631",
								"140256491061670378290250651841130515814",
								"236771863158546915586611010282028352219"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-184569329-b07e2673",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/system/core/+/aea97815308ab98faf1599c16d6190b787d34941",
						"target": {
							"file": "init/epoll.h"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-184569329.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/system/core"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2021-10-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/system/core/+/2cf268ab9fd5c4ac6ac4ce7d2ecead212f019fc0"
				],
				"severity": "High",
				"spl": "2021-10-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"256138232892956117866870139568461073285",
								"210901955371522732331476274575937147501",
								"71044469235361559697024243045342578651",
								"298486968480583062652358300718990121853",
								"198470958570169884216143815249370508518",
								"144424847953029706394940655558779159721",
								"328849048575849043808407977646358186686",
								"140978676307643273134672054552574612510",
								"40428537916653978894019786492890279609",
								"162727022106112610027853147196649408344",
								"20591997319400182566179770889043122724",
								"202812449965763165842019963335729207713",
								"196474102583057658122448055249878807204",
								"293110444877043788342245703148328803143",
								"282825968526689080629089878204136507465",
								"101493045286489171594783699499528104478",
								"287158927481532591624954278076523875220",
								"328392510797919960404777263467970348176"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-184569329-164df4e3",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/system/core/+/2cf268ab9fd5c4ac6ac4ce7d2ecead212f019fc0",
						"target": {
							"file": "init/epoll.cpp"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"328309416986978941964763700139281564765",
								"324118592480733914100375865052153519981",
								"148310415285163141198917495033497700105",
								"173261846682665274398296137622502839763",
								"234245473619591294809665721557795555579",
								"42369555006476525743163514753864323876",
								"66192061184800604454912141422104078394",
								"292653816015694727543108469855470597638",
								"165094782990866898258592092369424346133",
								"138814815098468961028611920680867551914",
								"73855890458803554921388581511882377543",
								"238809573335510810988767080431005283731",
								"95404780966911486944577072848118094631",
								"140256491061670378290250651841130515814",
								"236771863158546915586611010282028352219"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-184569329-6fa2ad6d",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/system/core/+/2cf268ab9fd5c4ac6ac4ce7d2ecead212f019fc0",
						"target": {
							"file": "init/epoll.h"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-184569329.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/system/core"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12:0"
						},
						{
							"fixed": "12:2021-10-01"
						}
					]
				}
			],
			"versions": [
				"12"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/system/core/+/1de7384c109a318c0b11bbb98bac50a10b093947"
				],
				"severity": "High",
				"spl": "2021-10-01",
				"types": [
					"Unknown"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"256138232892956117866870139568461073285",
								"210901955371522732331476274575937147501",
								"71044469235361559697024243045342578651",
								"298486968480583062652358300718990121853",
								"198470958570169884216143815249370508518",
								"144424847953029706394940655558779159721",
								"328849048575849043808407977646358186686",
								"140978676307643273134672054552574612510",
								"40428537916653978894019786492890279609",
								"162727022106112610027853147196649408344",
								"20591997319400182566179770889043122724",
								"202812449965763165842019963335729207713",
								"196474102583057658122448055249878807204",
								"293110444877043788342245703148328803143",
								"282825968526689080629089878204136507465",
								"101493045286489171594783699499528104478",
								"287158927481532591624954278076523875220",
								"328392510797919960404777263467970348176"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-184569329-9a2967a5",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/system/core/+/1de7384c109a318c0b11bbb98bac50a10b093947",
						"target": {
							"file": "init/epoll.cpp"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"328309416986978941964763700139281564765",
								"324118592480733914100375865052153519981",
								"148310415285163141198917495033497700105",
								"173261846682665274398296137622502839763",
								"234245473619591294809665721557795555579",
								"42369555006476525743163514753864323876",
								"66192061184800604454912141422104078394",
								"292653816015694727543108469855470597638",
								"165094782990866898258592092369424346133",
								"138814815098468961028611920680867551914",
								"73855890458803554921388581511882377543",
								"238809573335510810988767080431005283731",
								"95404780966911486944577072848118094631",
								"140256491061670378290250651841130515814",
								"236771863158546915586611010282028352219"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-184569329-aaa55630",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/system/core/+/1de7384c109a318c0b11bbb98bac50a10b093947",
						"target": {
							"file": "init/epoll.h"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-184569329.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2021-10-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/system/core/+/9792338c6c2b899ff708e4938e93d8e429d50442"
		}
	]
}
