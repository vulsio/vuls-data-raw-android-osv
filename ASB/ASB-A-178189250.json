{
	"schema_version": "1.6.0",
	"id": "ASB-A-178189250",
	"modified": "2024-11-06T12:16:03.231308Z",
	"published": "2021-05-01T00:00:00Z",
	"aliases": [
		"A-178189250",
		"CVE-2021-0477"
	],
	"details": "In notifyScreenshotError of ScreenshotNotificationsController.java, there is a possible permission bypass due to an unsafe PendingIntent. This could lead to local escalation of privilege with User execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "8.1:0"
						},
						{
							"fixed": "8.1:2021-05-01"
						}
					]
				}
			],
			"versions": [
				"8.1"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/3aa7d375b21e1fe129175def7f0c6fec52a1b0ae"
				],
				"severity": "High",
				"spl": "2021-05-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "284581138856102726586182727258222154103",
							"length": 1527
						},
						"id": "ASB-A-178189250-46304d9e",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/3aa7d375b21e1fe129175def7f0c6fec52a1b0ae",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/GlobalScreenshot.java",
							"function": "onPostExecute"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"271093197615424460729987039571770578444",
								"228312326731753021517411535231261164033",
								"330662932241626589708926623729431185028",
								"128639070867930988821120620597208751141",
								"325821438223542453362458701660913066569",
								"215611203597526608845598763823579987597",
								"267493371389919413174587853940680220987",
								"231003317207135042620838545351299866153",
								"190125444126967619438810615479714428892",
								"291690997379910661975272733196919626711",
								"325969477345948572073393577393615744813",
								"318481006977702437677634131366939613044",
								"5578222626770549655503071739929499895",
								"215611203597526608845598763823579987597",
								"267493371389919413174587853940680220987",
								"231003317207135042620838545351299866153",
								"42902915976875360482992069218001247169",
								"185439926692817154462937248766362456401",
								"46035363190068161867065149726279917037",
								"285419763374820293139325595955418585976",
								"202673949147402793100604051463580522953",
								"260927423001378719800273219250224048706",
								"166808631279276869565269666396058446348",
								"232265116274803826575469677568783670661",
								"77994523687306664348458532852713464020",
								"334282731247967107386227614259663605279",
								"214592263928156822515135475839180055934",
								"22395253828476674506323535525351146832",
								"296904608666948722688934058148136506994",
								"100361398435763466587076094882626946382",
								"177650596460815340269225943641320391153",
								"293825034753302678285333068832943160055",
								"189339555471363911199954600613934758767",
								"300184498046539160644874954867123773412",
								"49360029419697008652402486179552639199",
								"88949221603653775722629382332304225120",
								"237976536769535914937454957450561464740",
								"319942780573103918995064464269775398190",
								"312880699959685225689484832342028021186",
								"202715507518637756379822721386310978018",
								"64086159017010305806341680004662133423",
								"48629034943812128860562487446938760875",
								"84026668972039127362894943077293572089",
								"141606582808613974838190723336543274541",
								"43340152505709122220706257283457024024",
								"130146111284137426541692865803344614309",
								"160031109310627365969075250086834759723",
								"106174264383633844260507100942069806405",
								"201380268903788412698266572393331965192",
								"6012981015270143892017441483264790221",
								"184556315556547266792867592474603873482",
								"132227922267463844819738675324273477492",
								"98365693219425991085541048152690199212",
								"214343140382182257567223468773059492518",
								"62253028067829013458644442798622310308",
								"191541400995351085899198071082125984555",
								"111470956551771219661770558669321662732",
								"139363135210323134663609386280957798697",
								"175104672055168430717078462512920343517",
								"32044004969029256109437154114810895690",
								"148785854381185316366713724831278271505",
								"110991228243056525346814388630608556297",
								"21699807684932209405052497068142358998",
								"266944945934448281645914906792292872076",
								"317942486921985591883270435534028887937",
								"87106669126278139036466484867353167324",
								"117746929692043898925095267972084724351",
								"82282510620425721066008358457020343468",
								"75135532038447496278775991794626844816",
								"35288249547894163891707990786112687242",
								"92126334074088994017216652838667843145",
								"160157406064278959458581628104162111204",
								"93953788960278810390884113464205980326",
								"175692462121034439941868239291388028935",
								"47703957781074952698843488804994575722",
								"317125998249079591427556486196913195732",
								"20296029245790503480696382948883227451",
								"117542750633933121275835851538842151584",
								"254457099094434518692565750592759848195",
								"323627955318557187797612094588711297413",
								"96532948544043014414288645804168501315",
								"14533707391629623917602331641122606066",
								"241141028097908601335205365165002014466",
								"280702070867734850950166817336775262574",
								"311201071229088295055828987812203240534",
								"225517224340706905671825544273749973523",
								"305286576620536669241942197664872287203",
								"19467771356548001689948110561129791338"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-178189250-b5fde0d5",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/3aa7d375b21e1fe129175def7f0c6fec52a1b0ae",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/GlobalScreenshot.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "332426821246020684199756944663733506863",
							"length": 1145
						},
						"id": "ASB-A-178189250-ba2d00e5",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/3aa7d375b21e1fe129175def7f0c6fec52a1b0ae",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/GlobalScreenshot.java",
							"function": "notifyScreenshotError"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-178189250.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "9:0"
						},
						{
							"fixed": "9:2021-05-01"
						}
					]
				}
			],
			"versions": [
				"9"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/ed450d77edc632bbdf74f86fa76dae1f9475a5c9"
				],
				"severity": "High",
				"spl": "2021-05-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"271093197615424460729987039571770578444",
								"228312326731753021517411535231261164033",
								"330662932241626589708926623729431185028",
								"128639070867930988821120620597208751141",
								"114659448516927763253156654212014110802",
								"231473021840146086378874822697240488562",
								"221352911426135703374312389258952325250",
								"180936196464408694702733500061126536251",
								"309221681034640053450674937847481120150",
								"219332652661519455483613723438118654607",
								"155073914426766608503646922498207718132",
								"325817571222733924898956011331348558594",
								"272659447518720391789514803464537983590",
								"11596724307636544651169916838476396598",
								"325821438223542453362458701660913066569",
								"215611203597526608845598763823579987597",
								"267493371389919413174587853940680220987",
								"231003317207135042620838545351299866153",
								"190125444126967619438810615479714428892",
								"291690997379910661975272733196919626711",
								"325969477345948572073393577393615744813",
								"318481006977702437677634131366939613044",
								"5578222626770549655503071739929499895",
								"215611203597526608845598763823579987597",
								"267493371389919413174587853940680220987",
								"231003317207135042620838545351299866153",
								"42902915976875360482992069218001247169",
								"185439926692817154462937248766362456401",
								"46035363190068161867065149726279917037",
								"285419763374820293139325595955418585976",
								"202673949147402793100604051463580522953",
								"260927423001378719800273219250224048706",
								"166808631279276869565269666396058446348",
								"232265116274803826575469677568783670661",
								"77994523687306664348458532852713464020",
								"334282731247967107386227614259663605279",
								"214592263928156822515135475839180055934",
								"22395253828476674506323535525351146832",
								"296904608666948722688934058148136506994",
								"100361398435763466587076094882626946382",
								"242218537745602016565751345096817782228",
								"242379639365667984131876328651713186960",
								"338570942651146801588532775059082140770",
								"23998057228690661567781473112639294440",
								"300184498046539160644874954867123773412",
								"49360029419697008652402486179552639199",
								"88949221603653775722629382332304225120",
								"237976536769535914937454957450561464740",
								"319942780573103918995064464269775398190",
								"312880699959685225689484832342028021186",
								"202715507518637756379822721386310978018",
								"64086159017010305806341680004662133423",
								"48629034943812128860562487446938760875",
								"84026668972039127362894943077293572089",
								"141606582808613974838190723336543274541",
								"43340152505709122220706257283457024024",
								"130146111284137426541692865803344614309",
								"160031109310627365969075250086834759723",
								"106174264383633844260507100942069806405",
								"201380268903788412698266572393331965192",
								"6012981015270143892017441483264790221",
								"184556315556547266792867592474603873482",
								"132227922267463844819738675324273477492",
								"98365693219425991085541048152690199212",
								"214343140382182257567223468773059492518",
								"62253028067829013458644442798622310308",
								"191541400995351085899198071082125984555",
								"111470956551771219661770558669321662732",
								"139363135210323134663609386280957798697",
								"175104672055168430717078462512920343517",
								"32044004969029256109437154114810895690",
								"148785854381185316366713724831278271505",
								"110991228243056525346814388630608556297",
								"21699807684932209405052497068142358998",
								"266944945934448281645914906792292872076",
								"317942486921985591883270435534028887937",
								"87106669126278139036466484867353167324",
								"117746929692043898925095267972084724351",
								"82282510620425721066008358457020343468",
								"75135532038447496278775991794626844816",
								"35288249547894163891707990786112687242",
								"92126334074088994017216652838667843145",
								"160157406064278959458581628104162111204",
								"93953788960278810390884113464205980326",
								"175692462121034439941868239291388028935",
								"47703957781074952698843488804994575722",
								"317125998249079591427556486196913195732",
								"20296029245790503480696382948883227451",
								"117542750633933121275835851538842151584",
								"254457099094434518692565750592759848195",
								"323627955318557187797612094588711297413",
								"96532948544043014414288645804168501315",
								"14533707391629623917602331641122606066",
								"241141028097908601335205365165002014466",
								"280702070867734850950166817336775262574",
								"311201071229088295055828987812203240534",
								"225517224340706905671825544273749973523",
								"305286576620536669241942197664872287203",
								"151624301098622520414410811421065362851"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-178189250-0df83985",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/ed450d77edc632bbdf74f86fa76dae1f9475a5c9",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/GlobalScreenshot.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "284581138856102726586182727258222154103",
							"length": 1527
						},
						"id": "ASB-A-178189250-1abe5d49",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/ed450d77edc632bbdf74f86fa76dae1f9475a5c9",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/GlobalScreenshot.java",
							"function": "onPostExecute"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "110741113005841147326240017904181675160",
							"length": 1152
						},
						"id": "ASB-A-178189250-e53dd569",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/ed450d77edc632bbdf74f86fa76dae1f9475a5c9",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/GlobalScreenshot.java",
							"function": "notifyScreenshotError"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-178189250.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "10:0"
						},
						{
							"fixed": "10:2021-05-01"
						}
					]
				}
			],
			"versions": [
				"10"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/f4eefc55c432aee2d411f24cb1e0e5eec6d03670"
				],
				"severity": "High",
				"spl": "2021-05-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "110741113005841147326240017904181675160",
							"length": 1152
						},
						"id": "ASB-A-178189250-21b1e890",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/f4eefc55c432aee2d411f24cb1e0e5eec6d03670",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/GlobalScreenshot.java",
							"function": "notifyScreenshotError"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"271093197615424460729987039571770578444",
								"228312326731753021517411535231261164033",
								"330662932241626589708926623729431185028",
								"128639070867930988821120620597208751141",
								"114659448516927763253156654212014110802",
								"231473021840146086378874822697240488562",
								"221352911426135703374312389258952325250",
								"180936196464408694702733500061126536251",
								"309221681034640053450674937847481120150",
								"219332652661519455483613723438118654607",
								"155073914426766608503646922498207718132",
								"325817571222733924898956011331348558594",
								"272659447518720391789514803464537983590",
								"11596724307636544651169916838476396598",
								"325821438223542453362458701660913066569",
								"215611203597526608845598763823579987597",
								"267493371389919413174587853940680220987",
								"231003317207135042620838545351299866153",
								"190125444126967619438810615479714428892",
								"291690997379910661975272733196919626711",
								"325969477345948572073393577393615744813",
								"318481006977702437677634131366939613044",
								"5578222626770549655503071739929499895",
								"215611203597526608845598763823579987597",
								"267493371389919413174587853940680220987",
								"231003317207135042620838545351299866153",
								"42902915976875360482992069218001247169",
								"185439926692817154462937248766362456401",
								"46035363190068161867065149726279917037",
								"285419763374820293139325595955418585976",
								"202673949147402793100604051463580522953",
								"260927423001378719800273219250224048706",
								"10642859344326866523103201790471458897",
								"105103784553828212359697463888720631804",
								"77994523687306664348458532852713464020",
								"334282731247967107386227614259663605279",
								"214592263928156822515135475839180055934",
								"22395253828476674506323535525351146832",
								"296904608666948722688934058148136506994",
								"100361398435763466587076094882626946382",
								"242218537745602016565751345096817782228",
								"242379639365667984131876328651713186960",
								"338570942651146801588532775059082140770",
								"26199374871164740371419687326187230376",
								"263126157027587821188112773498283277938",
								"204358359267255322647491743362352157295",
								"6199468935370115055480168097753850901",
								"237976536769535914937454957450561464740",
								"319942780573103918995064464269775398190",
								"312880699959685225689484832342028021186",
								"202715507518637756379822721386310978018",
								"64086159017010305806341680004662133423",
								"48629034943812128860562487446938760875",
								"84026668972039127362894943077293572089",
								"141606582808613974838190723336543274541",
								"43340152505709122220706257283457024024",
								"130146111284137426541692865803344614309",
								"160031109310627365969075250086834759723",
								"106174264383633844260507100942069806405",
								"201380268903788412698266572393331965192",
								"6012981015270143892017441483264790221",
								"184556315556547266792867592474603873482",
								"132227922267463844819738675324273477492",
								"98365693219425991085541048152690199212",
								"214343140382182257567223468773059492518",
								"62253028067829013458644442798622310308",
								"191541400995351085899198071082125984555",
								"111470956551771219661770558669321662732",
								"139363135210323134663609386280957798697",
								"175104672055168430717078462512920343517",
								"32044004969029256109437154114810895690",
								"148785854381185316366713724831278271505",
								"110991228243056525346814388630608556297",
								"21699807684932209405052497068142358998",
								"266944945934448281645914906792292872076",
								"317942486921985591883270435534028887937",
								"87106669126278139036466484867353167324",
								"117746929692043898925095267972084724351",
								"82282510620425721066008358457020343468",
								"75135532038447496278775991794626844816",
								"35288249547894163891707990786112687242",
								"92126334074088994017216652838667843145",
								"160157406064278959458581628104162111204",
								"93953788960278810390884113464205980326",
								"175692462121034439941868239291388028935",
								"47703957781074952698843488804994575722",
								"317125998249079591427556486196913195732",
								"20296029245790503480696382948883227451",
								"117542750633933121275835851538842151584",
								"254457099094434518692565750592759848195",
								"323627955318557187797612094588711297413",
								"96532948544043014414288645804168501315",
								"14533707391629623917602331641122606066",
								"241141028097908601335205365165002014466",
								"280702070867734850950166817336775262574",
								"311201071229088295055828987812203240534",
								"225517224340706905671825544273749973523",
								"305286576620536669241942197664872287203",
								"151624301098622520414410811421065362851"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-178189250-5319b7b1",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/f4eefc55c432aee2d411f24cb1e0e5eec6d03670",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/GlobalScreenshot.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "284581138856102726586182727258222154103",
							"length": 1527
						},
						"id": "ASB-A-178189250-95b24aa1",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/f4eefc55c432aee2d411f24cb1e0e5eec6d03670",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/GlobalScreenshot.java",
							"function": "onPostExecute"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-178189250.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2021-05-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/1eecc874b6bda42a5a191684704e3bf424cf47da"
				],
				"severity": "High",
				"spl": "2021-05-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"282977835774808924701401098820018008724",
								"17891436760065830967447584697452672959",
								"169441129639095655921408489655755809107",
								"178921333895358683977848386004662195758"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-178189250-40f74680",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/1eecc874b6bda42a5a191684704e3bf424cf47da",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/ScreenshotNotificationsController.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "20515662023768134736340030899939348434",
							"length": 1180
						},
						"id": "ASB-A-178189250-af1af373",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/1eecc874b6bda42a5a191684704e3bf424cf47da",
						"target": {
							"file": "packages/SystemUI/src/com/android/systemui/screenshot/ScreenshotNotificationsController.java",
							"function": "notifyScreenshotError"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-178189250.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2021-05-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/frameworks/base/+/e01fef361bb7371e10b990737caed7a3799bdc3b"
		}
	]
}
