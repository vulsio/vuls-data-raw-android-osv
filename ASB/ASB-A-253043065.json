{
	"schema_version": "1.6.0",
	"id": "ASB-A-253043065",
	"modified": "2024-11-07T14:19:33.240022Z",
	"published": "2023-10-01T00:00:00Z",
	"aliases": [
		"A-253043065",
		"CVE-2023-40117"
	],
	"details": "In resetSettingsLocked of SettingsProvider.java, there is a possible lockscreen bypass due to a permissions bypass. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2023-10-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/f0f020c21fd29d8076733e07847e6314172a312e"
				],
				"severity": "High",
				"spl": "2023-10-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"170395276235639793363196021203634677004",
								"314580631116979850057675219354769422954",
								"274447574767380600846857427345672139192",
								"282768234191678381302654868457253311807",
								"16798451432759151909270418446985580488",
								"283032940313011857394229345655142575816",
								"211656041198882474892431282781043920773",
								"50518621489690850804106272592347808866",
								"236537355135669784640058684562919869161",
								"79004071114477159916956207560401596750",
								"90717595311191868161050011369115522056",
								"50518621489690850804106272592347808866",
								"236537355135669784640058684562919869161",
								"79004071114477159916956207560401596750",
								"324604640115019091072517578103146748862",
								"137824493714943122586437830896907422904",
								"326015862143435565553501171556323966126",
								"136901840373444531274522930626358029047",
								"324604640115019091072517578103146748862"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-91710098",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/f0f020c21fd29d8076733e07847e6314172a312e",
						"target": {
							"file": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "313806740060720509630948579405857782064",
							"length": 2207
						},
						"id": "ASB-A-253043065-c2b4d14f",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/f0f020c21fd29d8076733e07847e6314172a312e",
						"target": {
							"file": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java",
							"function": "resetSettingsLocked"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-253043065.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/apps/Settings"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2023-10-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/apps/Settings/+/5f07aba15008e2681d5a10435dc5e1485863f21f"
				],
				"severity": "High",
				"spl": "2023-10-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"158739243294855615477634017112047280076",
								"195543788545409919748051267183200407693",
								"121037068796424517204564184854386446585",
								"200401991832361626173012323807346981912",
								"287795410096940949792430972550503602616"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-7830bb35",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/5f07aba15008e2681d5a10435dc5e1485863f21f",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPassword.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "331896641899327464318422774423164495954",
							"length": 605
						},
						"id": "ASB-A-253043065-80d61cf5",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/5f07aba15008e2681d5a10435dc5e1485863f21f",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPattern.java",
							"function": "saveAndVerifyInBackground"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"223243321560897476047516935508300165996",
								"45836930825698107931128418521312544035",
								"189016484285807930410373496795410293388",
								"326060424708450181262358726082281286746",
								"270701640813610734348103458305837525620"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-8d6321d6",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/5f07aba15008e2681d5a10435dc5e1485863f21f",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPattern.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "124693866981663611715274381085931235016",
							"length": 589
						},
						"id": "ASB-A-253043065-f79ecb8a",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/5f07aba15008e2681d5a10435dc5e1485863f21f",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPassword.java",
							"function": "saveAndVerifyInBackground"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-253043065.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12:0"
						},
						{
							"fixed": "12:2023-10-01"
						}
					]
				}
			],
			"versions": [
				"12"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/30d1770dbfa5d5264083de4d50560e1bde3c4ba1"
				],
				"severity": "High",
				"spl": "2023-10-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"170395276235639793363196021203634677004",
								"314580631116979850057675219354769422954",
								"274447574767380600846857427345672139192",
								"282768234191678381302654868457253311807",
								"16798451432759151909270418446985580488",
								"283032940313011857394229345655142575816",
								"211656041198882474892431282781043920773",
								"21925520396604476149053192313011738224",
								"188841930365955053724279245824027586701",
								"80815868312338554119608312952023832459",
								"90717595311191868161050011369115522056",
								"21925520396604476149053192313011738224",
								"188841930365955053724279245824027586701",
								"80815868312338554119608312952023832459",
								"324604640115019091072517578103146748862",
								"137824493714943122586437830896907422904",
								"326015862143435565553501171556323966126",
								"136901840373444531274522930626358029047",
								"324604640115019091072517578103146748862"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-089b0ad6",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/30d1770dbfa5d5264083de4d50560e1bde3c4ba1",
						"target": {
							"file": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "68886660169400670503455311781686868729",
							"length": 2163
						},
						"id": "ASB-A-253043065-2024f3cf",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/30d1770dbfa5d5264083de4d50560e1bde3c4ba1",
						"target": {
							"file": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java",
							"function": "resetSettingsLocked"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-253043065.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/apps/Settings"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12:0"
						},
						{
							"fixed": "12:2023-10-01"
						}
					]
				}
			],
			"versions": [
				"12"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/apps/Settings/+/50cb0a35c92e7baa27ed6335079d2948a56d43e0"
				],
				"severity": "High",
				"spl": "2023-10-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "161918263687241813044930162459662663494",
							"length": 664
						},
						"id": "ASB-A-253043065-1e3fa39f",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/50cb0a35c92e7baa27ed6335079d2948a56d43e0",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPassword.java",
							"function": "saveAndVerifyInBackground"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"223243321560897476047516935508300165996",
								"45836930825698107931128418521312544035",
								"189016484285807930410373496795410293388",
								"326060424708450181262358726082281286746",
								"270701640813610734348103458305837525620"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-45a12c20",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/50cb0a35c92e7baa27ed6335079d2948a56d43e0",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPattern.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "111482870227228486687976737999604268607",
							"length": 681
						},
						"id": "ASB-A-253043065-8e3eefba",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/50cb0a35c92e7baa27ed6335079d2948a56d43e0",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPattern.java",
							"function": "saveAndVerifyInBackground"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"158739243294855615477634017112047280076",
								"195543788545409919748051267183200407693",
								"121037068796424517204564184854386446585",
								"200401991832361626173012323807346981912",
								"287795410096940949792430972550503602616"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-bab3ef76",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/50cb0a35c92e7baa27ed6335079d2948a56d43e0",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPassword.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-253043065.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12L:0"
						},
						{
							"fixed": "12L:2023-10-01"
						}
					]
				}
			],
			"versions": [
				"12L"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/a7ea34724f1bdebde64d9e9a1391c92dc2e189b5"
				],
				"severity": "High",
				"spl": "2023-10-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "68886660169400670503455311781686868729",
							"length": 2163
						},
						"id": "ASB-A-253043065-613d5fe2",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/a7ea34724f1bdebde64d9e9a1391c92dc2e189b5",
						"target": {
							"file": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java",
							"function": "resetSettingsLocked"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"170395276235639793363196021203634677004",
								"314580631116979850057675219354769422954",
								"274447574767380600846857427345672139192",
								"282768234191678381302654868457253311807",
								"16798451432759151909270418446985580488",
								"283032940313011857394229345655142575816",
								"211656041198882474892431282781043920773",
								"21925520396604476149053192313011738224",
								"188841930365955053724279245824027586701",
								"80815868312338554119608312952023832459",
								"90717595311191868161050011369115522056",
								"21925520396604476149053192313011738224",
								"188841930365955053724279245824027586701",
								"80815868312338554119608312952023832459",
								"324604640115019091072517578103146748862",
								"137824493714943122586437830896907422904",
								"326015862143435565553501171556323966126",
								"136901840373444531274522930626358029047",
								"324604640115019091072517578103146748862"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-9ad74496",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/a7ea34724f1bdebde64d9e9a1391c92dc2e189b5",
						"target": {
							"file": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-253043065.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/apps/Settings"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12L:0"
						},
						{
							"fixed": "12L:2023-10-01"
						}
					]
				}
			],
			"versions": [
				"12L"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/apps/Settings/+/6e92ca106eec83105943b701bd5653a6d6cc50f4"
				],
				"severity": "High",
				"spl": "2023-10-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "111482870227228486687976737999604268607",
							"length": 681
						},
						"id": "ASB-A-253043065-43fa4252",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/6e92ca106eec83105943b701bd5653a6d6cc50f4",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPattern.java",
							"function": "saveAndVerifyInBackground"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"158739243294855615477634017112047280076",
								"195543788545409919748051267183200407693",
								"121037068796424517204564184854386446585",
								"200401991832361626173012323807346981912",
								"287795410096940949792430972550503602616"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-6b4128f3",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/6e92ca106eec83105943b701bd5653a6d6cc50f4",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPassword.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"223243321560897476047516935508300165996",
								"45836930825698107931128418521312544035",
								"189016484285807930410373496795410293388",
								"326060424708450181262358726082281286746",
								"270701640813610734348103458305837525620"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-7a1909e6",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/6e92ca106eec83105943b701bd5653a6d6cc50f4",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPattern.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "161918263687241813044930162459662663494",
							"length": 664
						},
						"id": "ASB-A-253043065-ae8118fc",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/6e92ca106eec83105943b701bd5653a6d6cc50f4",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPassword.java",
							"function": "saveAndVerifyInBackground"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-253043065.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "13:0"
						},
						{
							"fixed": "13:2023-10-01"
						}
					]
				}
			],
			"versions": [
				"13"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/8c2d2c6fc91c6b80809a91ac510667af24d2cf17"
				],
				"severity": "High",
				"spl": "2023-10-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"170395276235639793363196021203634677004",
								"314580631116979850057675219354769422954",
								"274447574767380600846857427345672139192",
								"282768234191678381302654868457253311807",
								"16798451432759151909270418446985580488",
								"283032940313011857394229345655142575816",
								"211656041198882474892431282781043920773",
								"21925520396604476149053192313011738224",
								"188841930365955053724279245824027586701",
								"80815868312338554119608312952023832459",
								"90717595311191868161050011369115522056",
								"21925520396604476149053192313011738224",
								"188841930365955053724279245824027586701",
								"80815868312338554119608312952023832459",
								"324604640115019091072517578103146748862",
								"137824493714943122586437830896907422904",
								"326015862143435565553501171556323966126",
								"136901840373444531274522930626358029047",
								"324604640115019091072517578103146748862"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-61f4f85d",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/8c2d2c6fc91c6b80809a91ac510667af24d2cf17",
						"target": {
							"file": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "68886660169400670503455311781686868729",
							"length": 2163
						},
						"id": "ASB-A-253043065-68baf399",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/8c2d2c6fc91c6b80809a91ac510667af24d2cf17",
						"target": {
							"file": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java",
							"function": "resetSettingsLocked"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-253043065.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/apps/Settings"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "13:0"
						},
						{
							"fixed": "13:2023-10-01"
						}
					]
				}
			],
			"versions": [
				"13"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/apps/Settings/+/e0b5a793a19198370d479401101cea97c2f1d835"
				],
				"severity": "High",
				"spl": "2023-10-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "111482870227228486687976737999604268607",
							"length": 681
						},
						"id": "ASB-A-253043065-4459bb0c",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/e0b5a793a19198370d479401101cea97c2f1d835",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPattern.java",
							"function": "saveAndVerifyInBackground"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"223243321560897476047516935508300165996",
								"45836930825698107931128418521312544035",
								"189016484285807930410373496795410293388",
								"326060424708450181262358726082281286746",
								"270701640813610734348103458305837525620"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-560d164e",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/e0b5a793a19198370d479401101cea97c2f1d835",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPattern.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "161918263687241813044930162459662663494",
							"length": 664
						},
						"id": "ASB-A-253043065-d5fb5a9f",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/e0b5a793a19198370d479401101cea97c2f1d835",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPassword.java",
							"function": "saveAndVerifyInBackground"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"158739243294855615477634017112047280076",
								"195543788545409919748051267183200407693",
								"121037068796424517204564184854386446585",
								"200401991832361626173012323807346981912",
								"287795410096940949792430972550503602616"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-253043065-fe5dfb85",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/apps/Settings/+/e0b5a793a19198370d479401101cea97c2f1d835",
						"target": {
							"file": "src/com/android/settings/password/ChooseLockPassword.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-253043065.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2023-10-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/packages/apps/Settings/+/11815817de2f2d70fe842b108356a1bc75d44ffb"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/frameworks/base/+/ff86ff28cf82124f8e65833a2dd8c319aea08945"
		}
	]
}
