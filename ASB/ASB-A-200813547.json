{
	"schema_version": "1.6.0",
	"id": "ASB-A-200813547",
	"modified": "2024-08-07T19:29:54.459009Z",
	"published": "2022-03-01T00:00:00Z",
	"aliases": [
		"A-200813547",
		"CVE-2021-39697"
	],
	"details": "In checkFileUriDestination of DownloadProvider.java, there is a possible way to bypass external storage private directories protection due to a missing permission check. This could lead to local escalation of privilege with User execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/providers/DownloadProvider"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2022-03-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
					"https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/a1a7e7124f4804b587641dd2d0b4cadf6bb3ae1d"
				],
				"severity": "High",
				"spl": "2022-03-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "339552010433679439907244855020326203574",
							"length": 1933
						},
						"id": "ASB-A-200813547-0e66443a",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "checkFileUriDestination"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"220130647401496248365842946915104176115",
								"193612302426336820001077549906768341537",
								"39284183870650209241575357534300192843",
								"269986460546766493175564104539621599377",
								"80105699586655996406150983088501984024",
								"309396147470515383757235860641077324302",
								"159425579553148925127874491812644807799",
								"227273601412909805112145956717963534172",
								"180467816869655216115067702129957040449",
								"211549886684986423059021264283714562592",
								"239005688652439827801213712362437227115",
								"287073107612475039042180767665689272986",
								"73358008133622456883694713945089109159",
								"225537212531467922961715313497225259288",
								"143496423394496767457581176120279867398",
								"311767991283303323339961273649199216147",
								"203499759497393751725575411359627180907",
								"218762363857206390626419814168945735878",
								"204954418319788713546625550805304430936",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"204954418319788713546625550805304430936",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"47035882787231076478780517658649637535",
								"121893896739889695146168765603760966810",
								"48923478925968319318838915101118468896",
								"103414006466175946574185712222376902563",
								"204954418319788713546625550805304430936",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"79447296407323754819839261862254808417",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"113960176406182305535893352555800038176",
								"277202798099903834584646955983078321821",
								"127012190272197904421052904486789215451",
								"234021464402629670189659448519189264461",
								"501234662068958710912993239079178791",
								"38334338333609255823628262924066625337",
								"6202836269655158722805282133940002957",
								"41339738432679916697409787094702986442",
								"338499726504299927130801173974456087737",
								"101436464720602532557059130044493530575"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-200813547-13850792",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "55249957198382494214189307182363964622",
							"length": 7643
						},
						"id": "ASB-A-200813547-1a7e19d2",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "insert"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "192879395026705930347402862901440911515",
							"length": 1782
						},
						"id": "ASB-A-200813547-29cfa8fc",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "handleRemovedUidEntries"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "106897300003809470754034105429418390907",
							"length": 329
						},
						"id": "ASB-A-200813547-44ba893a",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "getCallingPackageTargetSdkVersion"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "74198812376932762575014405080776917385",
							"length": 227
						},
						"id": "ASB-A-200813547-4c9a4231",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValidInExternalObbDir"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"287261067283556007191945911722606186574",
								"20784885177638387157458703360846840932",
								"285869881578194002130169183494460058032",
								"297673591919739392731333200498362748662",
								"103302287878008301423553789522541843376",
								"4470727191344689129270741906688200374",
								"303527870304937432017102297810258887840",
								"74656513941696009391549499342363978048",
								"199137347582228539547104445110167373096",
								"243821782957790631866982041597279492262",
								"14382471217167372886998778317275632117",
								"286712224014421530285817106439035348885",
								"107565279459822545851645448824782704333",
								"8350305458502022115494458199138280369",
								"322513545887384080219782195007740208077",
								"182184582007608418886419162541914132742",
								"148212704377028974673601573182060265561",
								"174984850028559733750802331380917601642",
								"174070985240345600451350422778500547778",
								"102133308862322836724774030630893094188",
								"121620365692536280998338267202751950626",
								"222226478866571789222429603324375589234",
								"17920060698724299029769650256209551474",
								"49090298937048149122314584044789571182",
								"325057812537767393537380962776047405146",
								"15539640592547786693934634710098737511",
								"299500812157163240510238516644040343207",
								"243788689586786977441877544969404079970",
								"145195509876727555461917223152083905552",
								"286712224014421530285817106439035348885",
								"180972058895796264830708155969055616731",
								"126561483535659002959538878660390068034",
								"2590836639846371093921849348260944956",
								"160943370667601659241900715704093176788",
								"9200259336553782208778644646447102241",
								"86788440890069744622728515136537054854",
								"25520663737091414560944542217152020412",
								"112792450859639779465916046735222383542",
								"157044545497185145207695460466653489941",
								"142407603330344548294599366080125394664",
								"34117691176046204907051422285820622947",
								"104796515416995467029970411754808617319",
								"207879658975442063556390721186136676365",
								"101021904687629954700652345394850193430",
								"296158824365170221855366134676241547896",
								"61333270215300040445815099120211325145",
								"163075907974614613415329678374405126755",
								"254981484000400399427321526399198578956",
								"35113450680946413486328511574004288315",
								"174984850028559733750802331380917601642",
								"174070985240345600451350422778500547778",
								"84365622693280322045516091176856085429",
								"157544706323413757021861145760111982283",
								"162242780702381157036492266152874353484",
								"170540161808745087308188415603319801540",
								"331911627659631360017687776478750674663",
								"172023568234291375469446648947127530857",
								"5844571456445859888447877977830237808",
								"325057812537767393537380962776047405146",
								"15539640592547786693934634710098737511",
								"299500812157163240510238516644040343207",
								"243788689586786977441877544969404079970",
								"145195509876727555461917223152083905552",
								"286712224014421530285817106439035348885",
								"180972058895796264830708155969055616731",
								"126561483535659002959538878660390068034",
								"27751046023768538229125951949093598152",
								"161331138645980092354065683587611919361",
								"16691380905177327792416519385272784723",
								"296158824365170221855366134676241547896",
								"216898057272848446552335229411422516175",
								"279257752239675020014045229012400080916",
								"34112613011859576913760270379254123532",
								"163494094071736916082306554720665640337",
								"214756369842359361317274226667862763884",
								"15327182869484185202682245364141283710",
								"314068276977813364154491574432881118112",
								"54604760954032699590441742554317194152",
								"173054261872442540513396594049866312001",
								"176930919078472125376621106449670072673",
								"273393934737099872656478661838239455179",
								"87759595723560315841974113002675349475",
								"227142871294097228755896012797578226963",
								"161604231485859831521715078774295252774",
								"51187836382059356386233490953881845089",
								"145589079839709980406880077360501829529",
								"175674118570496822602515914999094706252"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-200813547-5e80c2c4",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "312544449190934229890982924797769085093",
							"length": 347
						},
						"id": "ASB-A-200813547-6275c56c",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValidInExternalPackage"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "211155944637022372168953382710645718696",
							"length": 585
						},
						"id": "ASB-A-200813547-8ccb78e5",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValid"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "22954863552772549776732447006557393746",
							"length": 261
						},
						"id": "ASB-A-200813547-9fdbb248",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValidInPublicDownloadsDir"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "83394232166988581450394315836713708420",
							"length": 1448
						},
						"id": "ASB-A-200813547-d4676cab",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "checkDownloadedFilePath"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "15380806526958628459824689465272127089",
							"length": 711
						},
						"id": "ASB-A-200813547-e0fa8edd",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/763fa2c8eb9b67866732ea52359169408f61464b",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "onCreate"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-200813547.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/providers/DownloadProvider"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12:0"
						},
						{
							"fixed": "12:2022-03-01"
						}
					]
				}
			],
			"versions": [
				"12"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
					"https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/e6152130e4e31c2d46e0e00c06a72fa40552d0dd"
				],
				"severity": "High",
				"spl": "2022-03-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "312544449190934229890982924797769085093",
							"length": 347
						},
						"id": "ASB-A-200813547-00de9e29",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValidInExternalPackage"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "22954863552772549776732447006557393746",
							"length": 261
						},
						"id": "ASB-A-200813547-09def27d",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValidInPublicDownloadsDir"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "106897300003809470754034105429418390907",
							"length": 329
						},
						"id": "ASB-A-200813547-138d01e1",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "getCallingPackageTargetSdkVersion"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "74198812376932762575014405080776917385",
							"length": 227
						},
						"id": "ASB-A-200813547-3b219ca5",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValidInExternalObbDir"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "83394232166988581450394315836713708420",
							"length": 1448
						},
						"id": "ASB-A-200813547-6d7c854d",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "checkDownloadedFilePath"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "339552010433679439907244855020326203574",
							"length": 1933
						},
						"id": "ASB-A-200813547-6e69cdfb",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "checkFileUriDestination"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"220130647401496248365842946915104176115",
								"193612302426336820001077549906768341537",
								"39284183870650209241575357534300192843",
								"269986460546766493175564104539621599377",
								"80105699586655996406150983088501984024",
								"309396147470515383757235860641077324302",
								"159425579553148925127874491812644807799",
								"227273601412909805112145956717963534172",
								"180467816869655216115067702129957040449",
								"211549886684986423059021264283714562592",
								"239005688652439827801213712362437227115",
								"287073107612475039042180767665689272986",
								"73358008133622456883694713945089109159",
								"225537212531467922961715313497225259288",
								"143496423394496767457581176120279867398",
								"311767991283303323339961273649199216147",
								"203499759497393751725575411359627180907",
								"218762363857206390626419814168945735878",
								"204954418319788713546625550805304430936",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"204954418319788713546625550805304430936",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"47035882787231076478780517658649637535",
								"121893896739889695146168765603760966810",
								"48923478925968319318838915101118468896",
								"103414006466175946574185712222376902563",
								"204954418319788713546625550805304430936",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"79447296407323754819839261862254808417",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"113960176406182305535893352555800038176",
								"277202798099903834584646955983078321821",
								"127012190272197904421052904486789215451",
								"234021464402629670189659448519189264461",
								"501234662068958710912993239079178791",
								"38334338333609255823628262924066625337",
								"6202836269655158722805282133940002957",
								"41339738432679916697409787094702986442",
								"338499726504299927130801173974456087737",
								"101436464720602532557059130044493530575"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-200813547-71551986",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "192879395026705930347402862901440911515",
							"length": 1782
						},
						"id": "ASB-A-200813547-73b94c64",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "handleRemovedUidEntries"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "211155944637022372168953382710645718696",
							"length": 585
						},
						"id": "ASB-A-200813547-774e44bb",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValid"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "15380806526958628459824689465272127089",
							"length": 711
						},
						"id": "ASB-A-200813547-d7382a13",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "onCreate"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "55249957198382494214189307182363964622",
							"length": 7643
						},
						"id": "ASB-A-200813547-e426fc49",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "insert"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"287261067283556007191945911722606186574",
								"20784885177638387157458703360846840932",
								"285869881578194002130169183494460058032",
								"297673591919739392731333200498362748662",
								"103302287878008301423553789522541843376",
								"4470727191344689129270741906688200374",
								"303527870304937432017102297810258887840",
								"74656513941696009391549499342363978048",
								"199137347582228539547104445110167373096",
								"243821782957790631866982041597279492262",
								"14382471217167372886998778317275632117",
								"286712224014421530285817106439035348885",
								"107565279459822545851645448824782704333",
								"8350305458502022115494458199138280369",
								"322513545887384080219782195007740208077",
								"182184582007608418886419162541914132742",
								"148212704377028974673601573182060265561",
								"174984850028559733750802331380917601642",
								"174070985240345600451350422778500547778",
								"102133308862322836724774030630893094188",
								"121620365692536280998338267202751950626",
								"222226478866571789222429603324375589234",
								"17920060698724299029769650256209551474",
								"49090298937048149122314584044789571182",
								"325057812537767393537380962776047405146",
								"15539640592547786693934634710098737511",
								"299500812157163240510238516644040343207",
								"243788689586786977441877544969404079970",
								"145195509876727555461917223152083905552",
								"286712224014421530285817106439035348885",
								"180972058895796264830708155969055616731",
								"126561483535659002959538878660390068034",
								"2590836639846371093921849348260944956",
								"160943370667601659241900715704093176788",
								"9200259336553782208778644646447102241",
								"86788440890069744622728515136537054854",
								"25520663737091414560944542217152020412",
								"112792450859639779465916046735222383542",
								"157044545497185145207695460466653489941",
								"142407603330344548294599366080125394664",
								"34117691176046204907051422285820622947",
								"104796515416995467029970411754808617319",
								"207879658975442063556390721186136676365",
								"101021904687629954700652345394850193430",
								"296158824365170221855366134676241547896",
								"61333270215300040445815099120211325145",
								"163075907974614613415329678374405126755",
								"254981484000400399427321526399198578956",
								"35113450680946413486328511574004288315",
								"174984850028559733750802331380917601642",
								"174070985240345600451350422778500547778",
								"84365622693280322045516091176856085429",
								"157544706323413757021861145760111982283",
								"162242780702381157036492266152874353484",
								"170540161808745087308188415603319801540",
								"331911627659631360017687776478750674663",
								"172023568234291375469446648947127530857",
								"5844571456445859888447877977830237808",
								"325057812537767393537380962776047405146",
								"15539640592547786693934634710098737511",
								"299500812157163240510238516644040343207",
								"243788689586786977441877544969404079970",
								"145195509876727555461917223152083905552",
								"286712224014421530285817106439035348885",
								"180972058895796264830708155969055616731",
								"126561483535659002959538878660390068034",
								"27751046023768538229125951949093598152",
								"161331138645980092354065683587611919361",
								"16691380905177327792416519385272784723",
								"296158824365170221855366134676241547896",
								"216898057272848446552335229411422516175",
								"279257752239675020014045229012400080916",
								"34112613011859576913760270379254123532",
								"163494094071736916082306554720665640337",
								"214756369842359361317274226667862763884",
								"15327182869484185202682245364141283710",
								"314068276977813364154491574432881118112",
								"54604760954032699590441742554317194152",
								"173054261872442540513396594049866312001",
								"176930919078472125376621106449670072673",
								"273393934737099872656478661838239455179",
								"87759595723560315841974113002675349475",
								"227142871294097228755896012797578226963",
								"161604231485859831521715078774295252774",
								"51187836382059356386233490953881845089",
								"145589079839709980406880077360501829529",
								"175674118570496822602515914999094706252"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-200813547-f7b71401",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/c39d04ac682138b32fed18ff06aa944126fc0432",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-200813547.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/packages/providers/DownloadProvider"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "12L:0"
						},
						{
							"fixed": "12L:2022-03-01"
						}
					]
				}
			],
			"versions": [
				"12L"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
					"https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/88b52beeb371f7db7e163028ed38406e784720ca"
				],
				"severity": "High",
				"spl": "2022-03-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "106897300003809470754034105429418390907",
							"length": 329
						},
						"id": "ASB-A-200813547-0f4b8bdb",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "getCallingPackageTargetSdkVersion"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "22954863552772549776732447006557393746",
							"length": 261
						},
						"id": "ASB-A-200813547-18ac4e27",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValidInPublicDownloadsDir"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "312544449190934229890982924797769085093",
							"length": 347
						},
						"id": "ASB-A-200813547-21c9b04e",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValidInExternalPackage"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "74198812376932762575014405080776917385",
							"length": 227
						},
						"id": "ASB-A-200813547-433da42e",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValidInExternalObbDir"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "339552010433679439907244855020326203574",
							"length": 1933
						},
						"id": "ASB-A-200813547-47a192aa",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "checkFileUriDestination"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "211155944637022372168953382710645718696",
							"length": 585
						},
						"id": "ASB-A-200813547-568906a6",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "isFilenameValid"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "55249957198382494214189307182363964622",
							"length": 7643
						},
						"id": "ASB-A-200813547-ac45a4b1",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "insert"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"220130647401496248365842946915104176115",
								"193612302426336820001077549906768341537",
								"39284183870650209241575357534300192843",
								"269986460546766493175564104539621599377",
								"80105699586655996406150983088501984024",
								"309396147470515383757235860641077324302",
								"159425579553148925127874491812644807799",
								"227273601412909805112145956717963534172",
								"180467816869655216115067702129957040449",
								"211549886684986423059021264283714562592",
								"239005688652439827801213712362437227115",
								"287073107612475039042180767665689272986",
								"73358008133622456883694713945089109159",
								"225537212531467922961715313497225259288",
								"143496423394496767457581176120279867398",
								"311767991283303323339961273649199216147",
								"203499759497393751725575411359627180907",
								"218762363857206390626419814168945735878",
								"204954418319788713546625550805304430936",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"204954418319788713546625550805304430936",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"47035882787231076478780517658649637535",
								"121893896739889695146168765603760966810",
								"48923478925968319318838915101118468896",
								"103414006466175946574185712222376902563",
								"204954418319788713546625550805304430936",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"79447296407323754819839261862254808417",
								"74232343942294772519294134342550207661",
								"26680893126123109918812037706372563036",
								"253997141517777689553844476761678247073",
								"113960176406182305535893352555800038176",
								"277202798099903834584646955983078321821",
								"127012190272197904421052904486789215451",
								"234021464402629670189659448519189264461",
								"501234662068958710912993239079178791",
								"38334338333609255823628262924066625337",
								"6202836269655158722805282133940002957",
								"41339738432679916697409787094702986442",
								"338499726504299927130801173974456087737",
								"101436464720602532557059130044493530575"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-200813547-c8903c33",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "192879395026705930347402862901440911515",
							"length": 1782
						},
						"id": "ASB-A-200813547-cc2c12ba",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/Helpers.java",
							"function": "handleRemovedUidEntries"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"287261067283556007191945911722606186574",
								"20784885177638387157458703360846840932",
								"285869881578194002130169183494460058032",
								"297673591919739392731333200498362748662",
								"103302287878008301423553789522541843376",
								"4470727191344689129270741906688200374",
								"303527870304937432017102297810258887840",
								"74656513941696009391549499342363978048",
								"199137347582228539547104445110167373096",
								"243821782957790631866982041597279492262",
								"14382471217167372886998778317275632117",
								"286712224014421530285817106439035348885",
								"107565279459822545851645448824782704333",
								"8350305458502022115494458199138280369",
								"322513545887384080219782195007740208077",
								"182184582007608418886419162541914132742",
								"148212704377028974673601573182060265561",
								"174984850028559733750802331380917601642",
								"174070985240345600451350422778500547778",
								"102133308862322836724774030630893094188",
								"121620365692536280998338267202751950626",
								"222226478866571789222429603324375589234",
								"17920060698724299029769650256209551474",
								"49090298937048149122314584044789571182",
								"325057812537767393537380962776047405146",
								"15539640592547786693934634710098737511",
								"299500812157163240510238516644040343207",
								"243788689586786977441877544969404079970",
								"145195509876727555461917223152083905552",
								"286712224014421530285817106439035348885",
								"180972058895796264830708155969055616731",
								"126561483535659002959538878660390068034",
								"2590836639846371093921849348260944956",
								"160943370667601659241900715704093176788",
								"9200259336553782208778644646447102241",
								"86788440890069744622728515136537054854",
								"25520663737091414560944542217152020412",
								"112792450859639779465916046735222383542",
								"157044545497185145207695460466653489941",
								"142407603330344548294599366080125394664",
								"34117691176046204907051422285820622947",
								"104796515416995467029970411754808617319",
								"207879658975442063556390721186136676365",
								"101021904687629954700652345394850193430",
								"296158824365170221855366134676241547896",
								"61333270215300040445815099120211325145",
								"163075907974614613415329678374405126755",
								"254981484000400399427321526399198578956",
								"35113450680946413486328511574004288315",
								"174984850028559733750802331380917601642",
								"174070985240345600451350422778500547778",
								"84365622693280322045516091176856085429",
								"157544706323413757021861145760111982283",
								"162242780702381157036492266152874353484",
								"170540161808745087308188415603319801540",
								"331911627659631360017687776478750674663",
								"172023568234291375469446648947127530857",
								"5844571456445859888447877977830237808",
								"325057812537767393537380962776047405146",
								"15539640592547786693934634710098737511",
								"299500812157163240510238516644040343207",
								"243788689586786977441877544969404079970",
								"145195509876727555461917223152083905552",
								"286712224014421530285817106439035348885",
								"180972058895796264830708155969055616731",
								"126561483535659002959538878660390068034",
								"27751046023768538229125951949093598152",
								"161331138645980092354065683587611919361",
								"16691380905177327792416519385272784723",
								"296158824365170221855366134676241547896",
								"216898057272848446552335229411422516175",
								"279257752239675020014045229012400080916",
								"34112613011859576913760270379254123532",
								"163494094071736916082306554720665640337",
								"214756369842359361317274226667862763884",
								"15327182869484185202682245364141283710",
								"314068276977813364154491574432881118112",
								"54604760954032699590441742554317194152",
								"173054261872442540513396594049866312001",
								"176930919078472125376621106449670072673",
								"273393934737099872656478661838239455179",
								"87759595723560315841974113002675349475",
								"227142871294097228755896012797578226963",
								"161604231485859831521715078774295252774",
								"51187836382059356386233490953881845089",
								"145589079839709980406880077360501829529",
								"175674118570496822602515914999094706252"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-200813547-d7c77ca4",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "83394232166988581450394315836713708420",
							"length": 1448
						},
						"id": "ASB-A-200813547-dee25cd8",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "checkDownloadedFilePath"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "15380806526958628459824689465272127089",
							"length": 711
						},
						"id": "ASB-A-200813547-e8d56a34",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/ed80e2c9ee0160757555bdd03ddcea78541152d1",
						"target": {
							"file": "src/com/android/providers/downloads/DownloadProvider.java",
							"function": "onCreate"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-200813547.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2022-03-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/0dc5048914eb6a7f919c8749172b971cbb315870"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/packages/providers/DownloadProvider/+/9ff84f6d353a7647efba91d74e31d17ba6b765b7"
		}
	]
}
