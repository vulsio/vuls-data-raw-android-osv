{
	"schema_version": "1.6.0",
	"id": "ASB-A-174661955",
	"modified": "2024-08-07T19:29:48.259618Z",
	"published": "2021-06-01T00:00:00Z",
	"aliases": [
		"A-174661955",
		"CVE-2021-0521"
	],
	"details": "In getAllPackages of PackageManagerService, there is a possible information disclosure due to a missing permission check. This could lead to local information disclosure of cross-user permissions with no additional execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "8.1:0"
						},
						{
							"fixed": "8.1:2021-06-01"
						}
					]
				}
			],
			"versions": [
				"8.1"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/cca5bf9282d37e132f2c4ba80ced5e6c074e8889"
				],
				"severity": "High",
				"spl": "2021-06-01",
				"types": [
					"ID"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"199711827891027318696610838834130616648",
								"138947170883316907437510034753088326807",
								"294500128474038364446721308433295141733",
								"263303962000383874338358230469893704254"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-174661955-7161894a",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/cca5bf9282d37e132f2c4ba80ced5e6c074e8889",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "202947986550377717574352750756989068473",
							"length": 817
						},
						"id": "ASB-A-174661955-ee38f3b9",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/cca5bf9282d37e132f2c4ba80ced5e6c074e8889",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java",
							"function": "getAllPackages"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-174661955.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "9:0"
						},
						{
							"fixed": "9:2021-06-01"
						}
					]
				}
			],
			"versions": [
				"9"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/264dea63b026d1f3e5217db632d3665fdbb3ffae"
				],
				"severity": "High",
				"spl": "2021-06-01",
				"types": [
					"ID"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"199711827891027318696610838834130616648",
								"138947170883316907437510034753088326807",
								"294500128474038364446721308433295141733",
								"263303962000383874338358230469893704254"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-174661955-76d1c69c",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/264dea63b026d1f3e5217db632d3665fdbb3ffae",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "202947986550377717574352750756989068473",
							"length": 817
						},
						"id": "ASB-A-174661955-acf349c6",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/264dea63b026d1f3e5217db632d3665fdbb3ffae",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java",
							"function": "getAllPackages"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-174661955.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "10:0"
						},
						{
							"fixed": "10:2021-06-01"
						}
					]
				}
			],
			"versions": [
				"10"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/83cc106ca0907f977d12fbf1a75f4090038fdccc"
				],
				"severity": "High",
				"spl": "2021-06-01",
				"types": [
					"ID"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "339890323062072521443264037110834275984",
							"length": 811
						},
						"id": "ASB-A-174661955-9b748fe7",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/83cc106ca0907f977d12fbf1a75f4090038fdccc",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java",
							"function": "getAllPackages"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"71341430926861086361325213125141907397",
								"199711827891027318696610838834130616648",
								"138947170883316907437510034753088326807",
								"294500128474038364446721308433295141733"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-174661955-c32e842a",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/83cc106ca0907f977d12fbf1a75f4090038fdccc",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-174661955.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/frameworks/base"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2021-06-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/frameworks/base/+/9b694ef4d45ca54bcc4b7de6940f5608047a1a16"
				],
				"severity": "High",
				"spl": "2021-06-01",
				"types": [
					"ID"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"64325443264029058411496765489288783420",
								"189794376678823856560689191942896471742",
								"61517342722270344720550994277124951614"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-174661955-6fa3c378",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/9b694ef4d45ca54bcc4b7de6940f5608047a1a16",
						"target": {
							"file": "core/java/android/os/Process.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"71341430926861086361325213125141907397",
								"199711827891027318696610838834130616648",
								"138947170883316907437510034753088326807",
								"50912303726426136706469972040810759692"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-174661955-9c405518",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/9b694ef4d45ca54bcc4b7de6940f5608047a1a16",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "114098694210717843319894783306117084955",
							"length": 778
						},
						"id": "ASB-A-174661955-cde6c335",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/frameworks/base/+/9b694ef4d45ca54bcc4b7de6940f5608047a1a16",
						"target": {
							"file": "services/core/java/com/android/server/pm/PackageManagerService.java",
							"function": "getAllPackages"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-174661955.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2021-06-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/frameworks/base/+/9b694ef4d45ca54bcc4b7de6940f5608047a1a16"
		}
	]
}
