{
	"schema_version": "1.6.0",
	"id": "ASB-A-185259758",
	"modified": "2024-08-07T19:29:30.569583Z",
	"published": "2021-07-01T00:00:00Z",
	"aliases": [
		"A-185259758",
		"CVE-2021-0587"
	],
	"details": "In StreamOut::prepareForWriting of StreamOut.cpp, there is a possible out of bounds write due to a use after free. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.",
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/hardware/interfaces"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "8.1:0"
						},
						{
							"fixed": "8.1:2021-07-01"
						}
					]
				}
			],
			"versions": [
				"8.1"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/hardware/interfaces/+/bd78085f08d5e342a1e0b02dde7a25832c2dd62e"
				],
				"severity": "High",
				"spl": "2021-07-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "150287074750092993895519176907219701872",
							"length": 2677
						},
						"id": "ASB-A-185259758-0fbdebc6",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/bd78085f08d5e342a1e0b02dde7a25832c2dd62e",
						"target": {
							"file": "audio/2.0/default/StreamIn.cpp",
							"function": "StreamIn::prepareForReading"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "254011858101809659284666545372006760443",
							"length": 2682
						},
						"id": "ASB-A-185259758-8f302fcd",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/bd78085f08d5e342a1e0b02dde7a25832c2dd62e",
						"target": {
							"file": "audio/2.0/default/StreamOut.cpp",
							"function": "StreamOut::prepareForWriting"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"48444534803010304391178084107537918840",
								"120361034126201748981816090137706395303",
								"268632988093653491463288490963889884234",
								"57266829813809952502325317997264172566",
								"249956254231897287438454395230771906409",
								"8506609035840382798536621936751063676",
								"329410127137314649785162139202405352179",
								"101519279898043915004061375592926133028",
								"192467788290305551192862302864771667757",
								"336315337574927840822360651599599001216"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-185259758-a1dab2f8",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/bd78085f08d5e342a1e0b02dde7a25832c2dd62e",
						"target": {
							"file": "audio/2.0/default/StreamOut.cpp"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"224965953965169143226339804704780514565",
								"166011243923715033453011681497686537519",
								"303399984315541761526670568588381923848",
								"244351529794255956041340714409172066737",
								"216049005460785330984390579428076912687",
								"119281494285972587425045203610991021920",
								"334832371707430806692781220287826763587",
								"212523963463534970698245507789945341767",
								"11978392291396371860852053166186842964",
								"238558191351021168489765734321552550785"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-185259758-b0093308",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/bd78085f08d5e342a1e0b02dde7a25832c2dd62e",
						"target": {
							"file": "audio/2.0/default/StreamIn.cpp"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-185259758.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/hardware/interfaces"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "9:0"
						},
						{
							"fixed": "9:2021-07-01"
						}
					]
				}
			],
			"versions": [
				"9"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/hardware/interfaces/+/9f6d6ae26c1f0a6d03fb8c035565a25104aa3c6d"
				],
				"severity": "High",
				"spl": "2021-07-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "255918426354636318680628364790253046642",
							"length": 2675
						},
						"id": "ASB-A-185259758-42ff3755",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/9f6d6ae26c1f0a6d03fb8c035565a25104aa3c6d",
						"target": {
							"file": "audio/core/all-versions/default/include/core/all-versions/default/StreamOut.impl.h",
							"function": "StreamOut::prepareForWriting"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "211883823323125091210163251822555335533",
							"length": 2670
						},
						"id": "ASB-A-185259758-826a9129",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/9f6d6ae26c1f0a6d03fb8c035565a25104aa3c6d",
						"target": {
							"file": "audio/core/all-versions/default/include/core/all-versions/default/StreamIn.impl.h",
							"function": "StreamIn::prepareForReading"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"82049381686152361061614341064218419157",
								"150153266414077831987376832035850089296",
								"303399984315541761526670568588381923848",
								"244351529794255956041340714409172066737",
								"241450331098341300467714119809573614805",
								"232598074563814131137107305157821442624",
								"334832371707430806692781220287826763587",
								"212523963463534970698245507789945341767",
								"11978392291396371860852053166186842964",
								"238558191351021168489765734321552550785"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-185259758-a6ca88ec",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/9f6d6ae26c1f0a6d03fb8c035565a25104aa3c6d",
						"target": {
							"file": "audio/core/all-versions/default/include/core/all-versions/default/StreamIn.impl.h"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"8052375145255489442672186172377949482",
								"89668748256686807740687131430442492588",
								"268632988093653491463288490963889884234",
								"57266829813809952502325317997264172566",
								"149347499663769153555368385546620669734",
								"190291235200606783331785644866240337398",
								"329410127137314649785162139202405352179",
								"101519279898043915004061375592926133028",
								"192467788290305551192862302864771667757",
								"336315337574927840822360651599599001216"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-185259758-ed144c30",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/9f6d6ae26c1f0a6d03fb8c035565a25104aa3c6d",
						"target": {
							"file": "audio/core/all-versions/default/include/core/all-versions/default/StreamOut.impl.h"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-185259758.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/hardware/interfaces"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "10:0"
						},
						{
							"fixed": "10:2021-07-01"
						}
					]
				}
			],
			"versions": [
				"10"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344"
				],
				"severity": "High",
				"spl": "2021-07-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"function_hash": "255918426354636318680628364790253046642",
							"length": 2675
						},
						"id": "ASB-A-185259758-0f6ce0a8",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344",
						"target": {
							"file": "audio/core/all-versions/default/StreamOut.cpp",
							"function": "StreamOut::prepareForWriting"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"82049381686152361061614341064218419157",
								"150153266414077831987376832035850089296",
								"303399984315541761526670568588381923848",
								"244351529794255956041340714409172066737",
								"241450331098341300467714119809573614805",
								"232598074563814131137107305157821442624",
								"334832371707430806692781220287826763587",
								"212523963463534970698245507789945341767",
								"11978392291396371860852053166186842964",
								"238558191351021168489765734321552550785"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-185259758-6fbed97e",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344",
						"target": {
							"file": "audio/core/all-versions/default/StreamIn.cpp"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"8052375145255489442672186172377949482",
								"89668748256686807740687131430442492588",
								"268632988093653491463288490963889884234",
								"57266829813809952502325317997264172566",
								"149347499663769153555368385546620669734",
								"190291235200606783331785644866240337398",
								"329410127137314649785162139202405352179",
								"101519279898043915004061375592926133028",
								"192467788290305551192862302864771667757",
								"336315337574927840822360651599599001216"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-185259758-a43a752b",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344",
						"target": {
							"file": "audio/core/all-versions/default/StreamOut.cpp"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "211883823323125091210163251822555335533",
							"length": 2670
						},
						"id": "ASB-A-185259758-ca750da3",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344",
						"target": {
							"file": "audio/core/all-versions/default/StreamIn.cpp",
							"function": "StreamIn::prepareForReading"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-185259758.json"
			}
		},
		{
			"package": {
				"ecosystem": "Android",
				"name": "platform/hardware/interfaces"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "11:0"
						},
						{
							"fixed": "11:2021-07-01"
						}
					]
				}
			],
			"versions": [
				"11"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344"
				],
				"severity": "High",
				"spl": "2021-07-01",
				"types": [
					"EoP"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"82049381686152361061614341064218419157",
								"150153266414077831987376832035850089296",
								"303399984315541761526670568588381923848",
								"244351529794255956041340714409172066737",
								"241450331098341300467714119809573614805",
								"232598074563814131137107305157821442624",
								"334832371707430806692781220287826763587",
								"212523963463534970698245507789945341767",
								"11978392291396371860852053166186842964",
								"238558191351021168489765734321552550785"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-185259758-0abd34fe",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344",
						"target": {
							"file": "audio/core/all-versions/default/StreamIn.cpp"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "255918426354636318680628364790253046642",
							"length": 2675
						},
						"id": "ASB-A-185259758-8ca13532",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344",
						"target": {
							"file": "audio/core/all-versions/default/StreamOut.cpp",
							"function": "StreamOut::prepareForWriting"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"8052375145255489442672186172377949482",
								"89668748256686807740687131430442492588",
								"268632988093653491463288490963889884234",
								"57266829813809952502325317997264172566",
								"149347499663769153555368385546620669734",
								"190291235200606783331785644866240337398",
								"329410127137314649785162139202405352179",
								"101519279898043915004061375592926133028",
								"192467788290305551192862302864771667757",
								"336315337574927840822360651599599001216"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-185259758-df2bf1b5",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344",
						"target": {
							"file": "audio/core/all-versions/default/StreamOut.cpp"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "211883823323125091210163251822555335533",
							"length": 2670
						},
						"id": "ASB-A-185259758-e6c23b77",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://android.googlesource.com/platform/hardware/interfaces/+/7283cbe8cbb250fc42f0358d4ca4c94f3c32b344",
						"target": {
							"file": "audio/core/all-versions/default/StreamIn.cpp",
							"function": "StreamIn::prepareForReading"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-185259758.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2021-07-01"
		},
		{
			"type": "FIX",
			"url": "https://android.googlesource.com/platform/hardware/interfaces/+/2f0fe27a2bfef0b5b4621009865ed6a8bae64447"
		}
	]
}
