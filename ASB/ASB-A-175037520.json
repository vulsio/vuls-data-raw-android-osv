{
	"schema_version": "1.6.0",
	"id": "ASB-A-175037520",
	"modified": "2024-08-13T23:59:27.812206Z",
	"published": "2021-08-01T00:00:00Z",
	"aliases": [
		"2778197",
		"2835930",
		"A-175037520",
		"CVE-2021-1904"
	],
	"affected": [
		{
			"package": {
				"ecosystem": "Android",
				"name": ":linux_kernel:Qualcomm"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "SoCVersion:0"
						},
						{
							"fixed": "SoCVersion:2021-08-05"
						}
					]
				}
			],
			"versions": [
				"SoCVersion"
			],
			"ecosystem_specific": {
				"fixes": [
					"https://source.codeaurora.org/quic/la/kernel/msm-4.4/commit/?id=842c19d464a9bd0f6f1a4bb353e95d1dc067abc7",
					"https://source.codeaurora.org/quic/la/kernel/msm-4.14/commit/?id=dc1189fa07e91885a5261435ad1f2fa60abde398"
				],
				"severity": "High",
				"spl": "2021-08-05",
				"types": [
					"Unknown"
				],
				"vanir_signatures": [
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"13300572114648605249287599791121761499",
								"32780589795607271693537127136124980812",
								"229420551526518730389614941506950023798",
								"165631224931833002090066115593103701220",
								"61173133556627353510575637094041156988",
								"228801762859509785981403379168168094998",
								"136919239393772995241245343200606512181",
								"199134845798910954832930949035269010983",
								"106435177473592171628300424867577110607",
								"34362263406915949356797532850450283138",
								"139746609098985687418978371470969353176",
								"170284648345750683404618120896776571934",
								"217727207068394791303577024743256670144",
								"63579682030352923980859823673098225028"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-175037520-08abb1f8",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_debugfs.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "24881836351094184813103797833279560606",
							"length": 1722
						},
						"id": "ASB-A-175037520-0af1f5e4",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/adreno_debugfs.c",
							"function": "ctx_print"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"332095304713562056221335193063569375046",
								"272602221435386688924503535604251485767",
								"210073129116022193028620712244485342117",
								"223369886697780914032109096035632517558"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-175037520-0b14062e",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/adreno_dispatch.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "318169118621913893476544251130221022969",
							"length": 1424
						},
						"id": "ASB-A-175037520-1921c49e",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/adreno_profile.c",
							"function": "_build_pre_ib_cmds"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "18184891328041398283234213280408435542",
							"length": 477
						},
						"id": "ASB-A-175037520-2852cfc6",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl.c",
							"function": "gpumem_free_func"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "330803439887859929836293571176322038885",
							"length": 1169
						},
						"id": "ASB-A-175037520-28c45715",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl.c",
							"function": "kgsl_get_unmapped_area"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "124648485465952672429246594804929897015",
							"length": 315
						},
						"id": "ASB-A-175037520-2ccf5d84",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl.c",
							"function": "kgsl_process_private_find"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "141784089976004548538251659840495903310",
							"length": 920
						},
						"id": "ASB-A-175037520-32a4c804",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl.c",
							"function": "kgsl_process_private_new"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "325488385376786339681874813706574175557",
							"length": 451
						},
						"id": "ASB-A-175037520-392bf8a1",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_device.h",
							"function": "kgsl_process_sub_stats"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"195315844033166367539954221421711846450",
								"36018463276196995597459329442117636258",
								"194076154521596090825009799359092504553",
								"144845866677693153264235956452724984180",
								"169205036394439659000596193760374568403"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-175037520-3c7b38ad",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/adreno_debugfs.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "259567819627737900075849019414632514969",
							"length": 1491
						},
						"id": "ASB-A-175037520-43799cc4",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl.c",
							"function": "kgsl_context_init"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"246277873900922102991159962494204164670",
								"98276054100311629312648213857783436704",
								"221515938246605627917090098099246418284",
								"177718351842569640635228843142176101358",
								"193610885397499647712817616124305793458",
								"7369206450717951420418425883968594941",
								"157613811513680465602617801316110620929",
								"18431514572397600821293833417281588537",
								"313990075519151132934834907511580179777",
								"191021333925472756485391087966767648796",
								"45665873768696605817052541181013151841",
								"134357192996896949048191029127772461281"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-175037520-44448835",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_iommu.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"272034100092773841769402680478129529983",
								"254275544057103353593848166410824199407",
								"28502935726063854236329965352439299994",
								"221576803221825666697797105198156861706",
								"162971991179227543841543150393860358455"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-175037520-75652a30",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/adreno_profile.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "10093948213871117437299887314535158178",
							"length": 326
						},
						"id": "ASB-A-175037520-78de1f8b",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl.c",
							"function": "gpumem_free_entry"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "213557173692483083906994773446586559676",
							"length": 345
						},
						"id": "ASB-A-175037520-873fcd23",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl.c",
							"function": "kgsl_destroy_process_private"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"84669068665732025566552376924565839150",
								"120010263033135293208007685419096359219",
								"106563989481957850237593405230545008065",
								"88972981575615492316647677513284181325",
								"169194487267930525169499079562314981922",
								"176795600467581139795815206222033577539",
								"43085472560489730193931445291931237760",
								"5981224861478783849273453120443810815",
								"76809550361438079423287872843122407654",
								"339135820389385911348130769078507624917",
								"122114892988760125451977828851290568754",
								"202861552388642287706635000593570657572"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-175037520-8b235bb3",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_device.h"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"231097612618410506968966110908469381466",
								"10784924852343566513800413023970142371",
								"318133980914531544372212187254144615215",
								"120366957191036803411472681559700545987",
								"117015099463496404478088006562448058822",
								"94878635725706063504111833547288480879",
								"131633751315742734466513893061395134013",
								"158887678788362442941959632115380564524",
								"133254658284823910659825482636800714290",
								"221119448908659670299984479229965715054",
								"69518558354688311613205295201193546951",
								"96746252069555350742856746691812791088",
								"115478733451083975875870733079849843087",
								"58094744869108013410615592267678728825",
								"289137081675894991913054974744611203730",
								"123363399529950213570584602879270080276",
								"229067237520284568718080644831072809620",
								"295260566171011052126572626580251699693",
								"59049074464994607159645623453248506471",
								"161402555285432613867445808376118147079",
								"71858983326717096623368177826071339817",
								"32998957310621766505737104823245936333",
								"213684178738298776322892687645091493259",
								"148919443561632788425221429514848173118",
								"324548328958479878037663707483566052625",
								"61953006992206172280368195588590121208",
								"209758416141387070241073776890639914197",
								"24482834010655638307339551726052301304",
								"208596367219167859567929386604912920716",
								"190373299194741997229200726222527886674",
								"295382629289988419905447104237611736172",
								"168147556100159479684061072906954496012",
								"51914344885090724340840083601539813429",
								"46695113971341384791814715099924250853",
								"334828062496714552555802708643120011559",
								"225390694463828476942872765543907983266",
								"328463279733345644176646556228156077368",
								"118119886646951117067620557941263489650",
								"334828062496714552555802708643120011559",
								"303695171533946265042574040866913932582",
								"248183878656798719030646279467379552530",
								"46695113971341384791814715099924250853",
								"334828062496714552555802708643120011559",
								"152448288082608222251630797626727483954",
								"208048364330115064851029437437415181462",
								"86258213227581282860891070140902712113",
								"179691445501576953844624209381636534882",
								"226650108315919921954038423432185158304",
								"289775591035361368929595628675961254138",
								"221424466650163276587969864937153327886",
								"75519356489672249207548996413189459155",
								"145795169654006179050599827497243591860",
								"258617114578322581110065897773286965239"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-175037520-8c6aaca9",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "114979451614573251939097950944975310287",
							"length": 850
						},
						"id": "ASB-A-175037520-9e2f6dbf",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_debugfs.c",
							"function": "kgsl_process_init_debugfs"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "156692853115723104376449149934298714753",
							"length": 383
						},
						"id": "ASB-A-175037520-bad600fc",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl.c",
							"function": "gpuobj_free_fence_func"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"81760578831568634669506740896531038906",
								"150693977086059208929880807234207260029",
								"322534449713036112984087652973676096052",
								"152154311983414333344617728363453637685",
								"207388030120656658122270970487729919554",
								"313901319498072702304933112681993670823",
								"125410970485236799978359575093718236294",
								"245909137755670108364689184541299138817",
								"207388030120656658122270970487729919554",
								"43463037511552054685111333013091833057",
								"204988725243121557428837743162138578649",
								"245909137755670108364689184541299138817",
								"207388030120656658122270970487729919554",
								"109758711995275074511139292240891404031",
								"149357803988753919324187723015577705695",
								"235719956972531182882815714041333912401",
								"25883365795811544355144425708465192866"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-175037520-bfb0adf5",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_trace.h"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"line_hashes": [
								"99904053006631252985127683433845545322",
								"35966395287502531674226716836427049071",
								"212395737675684639360969109528329205297",
								"265898022986910790876287275611024192002"
							],
							"threshold": 0.9
						},
						"id": "ASB-A-175037520-c56b9320",
						"signature_type": "Line",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_sharedmem.c"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "48753569831740123090128998816117593076",
							"length": 959
						},
						"id": "ASB-A-175037520-d316817e",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_sharedmem.c",
							"function": "kgsl_process_init_sysfs"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "245706924677198673104763612511271742420",
							"length": 1010
						},
						"id": "ASB-A-175037520-ea726326",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_iommu.c",
							"function": "_get_entries"
						}
					},
					{
						"deprecated": false,
						"digest": {
							"function_hash": "317591930372888218281924809985524053813",
							"length": 3235
						},
						"id": "ASB-A-175037520-fb9ca2d9",
						"signature_type": "Function",
						"signature_version": "v1",
						"source": "https://git.codelinaro.org/clo/la/kernel/msm-4.14/commit/dc1189fa07e91885a5261435ad1f2fa60abde398",
						"target": {
							"file": "drivers/gpu/msm/kgsl_iommu.c",
							"function": "kgsl_iommu_fault_handler"
						}
					}
				]
			},
			"database_specific": {
				"source": "https://storage.googleapis.com/android-osv/ASB-A-175037520.json"
			}
		}
	],
	"references": [
		{
			"type": "ADVISORY",
			"url": "https://source.android.com/security/bulletin/2021-08-01"
		},
		{
			"type": "FIX",
			"url": "https://source.codeaurora.org/quic/la/kernel/msm-4.4/commit/?id=842c19d464a9bd0f6f1a4bb353e95d1dc067abc7"
		},
		{
			"type": "FIX",
			"url": "https://source.codeaurora.org/quic/la/kernel/msm-4.14/commit/?id=dc1189fa07e91885a5261435ad1f2fa60abde398"
		}
	]
}
